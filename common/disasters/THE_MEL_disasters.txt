THE_MEL_performance_traveler_character_disaster = {
	potential = {
		has_country_flag = THE_MEL_set_traveler_character_performance_flag
	}
	can_start = {
		stability = 1
	}
	can_stop = {
		NOT = {
			stability = 1
		}
	}
	progress = {
		modifier = {
			factor = 0.5
			total_development = 250
		}
		modifier = {
			factor = 0.5
			total_development = 500
		}
		modifier = {
			factor = 0.5
			total_development = 1000
		}
		modifier = {
			factor = 0.25
			stability = 1
		}
		modifier = {
			factor = 0.25
			stability = 2
		}
		modifier = {
			factor = -100
			is_bankrupt = yes
		}
		modifier = {
			factor = -1
			NOT = { stability = 0 }
		}
		modifier = {
			factor = -1
			any_neighbor_province = {
				is_core = ROOT
			}
		}
		modifier = {
			factor = -1
			NOT = {
				any_neighbor_province = {
					is_core = ROOT
				}
			}
		}
		modifier = {
			factor = -1
			any_owned_province = {
				devastation = 1
			}
		}
		modifier = {
			factor = 0.25
			legitimacy = 90
		}
		modifier = {
			factor = -0.5
			NOT = {
				legitimacy = 80
			}
		}
		modifier = {
			factor = 0.25
			years_of_income = 2.0
		}
		modifier = {
			factor = 0.25
			years_of_income = 4
		}
		modifier = {
			factor = 0.5
			years_of_income = 8
		}
		modifier = {
			factor = 0.5
			years_of_income = 12
		}
		modifier = {
			factor = -0.5
			NOT = {
				years_of_income = 0.5
			}
		}
		modifier = {
			factor = -0.5
			NOT = {
				years_of_income = 0.5
			}
		}
		modifier = {
			factor = -1
			NOT = {
				years_of_income = 0.2
			}
		}
		modifier = {
			factor = 0.25
			monthly_income = 25
		}
		modifier = {
			factor = 0.25
			monthly_income = 50
		}
		modifier = {
			factor = 0.5
			monthly_income = 100
		}
		modifier = {
			factor = 0.5
			monthly_income = 200
		}
		modifier = {
			factor = 1.5
			monthly_income = 100
		}
	}
	can_end = {
		custom_trigger_tooltip = {
			tooltip = THE_MEL_performance_queen_character_disaster_c_tt1
			had_country_flag = {
				flag = THE_MEL_had_the_traveler_character_performance_flag
				days = 18250
			}
		}
	}
	on_monthly = {
		
	}
	on_start_effect = {
		hidden_effect = {
			clr_country_flag = THE_MEL_having_the_performance_event_flag
			set_country_flag = THE_MEL_had_the_traveler_character_performance_flag
		}
		add_adm_power = 300
		add_dip_power = 300
		add_mil_power = 300
		hidden_effect = {
			change_variable = {
				which = the_mel_complete_traveler_character_var
				value = 1
			}
			add_prestige = 20
			add_estate_loyalty = {
				estate = estate_nobles
				loyalty = 10
			}
			add_estate_loyalty = {
				estate = estate_burghers
				loyalty = 10
			}
			add_estate_loyalty = {
				estate = estate_church
				loyalty = 10
			}
			if = {
				limit = {
					mission_completed = THE_MEL_1_3
				}
				add_mercantilism_or_monarch_power = 4
			}
		}
	}
	on_end = THE_MEL_events.5
	modifier = {
		movement_speed = 0.10
		trade_efficiency = 0.20
		colonists = 1
	}
}

THE_MEL_performance_princess_character_disaster = {
	potential = {
		tag = MEL
		has_government_attribute = THE_MEL_sound_of_valley_lily_reform_mechanic
		has_country_flag = THE_MEL_set_princess_character_performance_flag
	}
	can_start = {
		stability = 1
	}
	can_stop = {
		NOT = {
			stability = 1
		}
	}
	progress = {
		modifier = {
			factor = 0.5
			total_development = 250
		}
		modifier = {
			factor = 0.5
			total_development = 500
		}
		modifier = {
			factor = 0.5
			total_development = 1000
		}
		modifier = {
			factor = 0.25
			stability = 1
		}
		modifier = {
			factor = 0.25
			stability = 2
		}
		modifier = {
			factor = 1
			is_subject = no
		}
		modifier = {
			factor = 0.5
			NOT = {
				war_exhaustion = 2
			}
		}
		modifier = {
			factor = 0.25
			num_of_royal_marriages = 1
		}
		modifier = {
			factor = 0.25
			num_of_royal_marriages = 2
		}
		modifier = {
			factor = 0.25
			num_of_royal_marriages = 3
		}
		modifier = {
			factor = 0.25
			num_of_royal_marriages = 4
		}
		modifier = {
			factor = 0.5
			custom_trigger_tooltip = {
				tooltip = THE_MEL_performance_princess_character_disaster_trigger_c_tt1
				check_variable = {
					which = the_mel_won_war_number_once_var
					value = 2
				}
			}
		}
		modifier = {
			factor = 0.5
			custom_trigger_tooltip = {
				tooltip = THE_MEL_performance_princess_character_disaster_trigger_c_tt2
				check_variable = {
					which = the_mel_won_war_number_once_var
					value = 3
				}
			}
		}
		modifier = {
			factor = -1.5
			custom_trigger_tooltip = {
				tooltip = THE_MEL_performance_princess_character_disaster_trigger_c_tt3
				NOT = {
					check_variable = {
						which = the_mel_won_war_number_once_var
						value = 1
					}
				}
			}
		}
		#
		modifier = {
			factor = -1
			NOT = { stability = 0 }
		}
		modifier = {
			factor = -2.5
			is_subject = yes
		}
		modifier = {
			factor = -1
			war_exhaustion = 2
		}
		modifier = {
			factor = -1
			NOT = { any_country = { marriage_with = ROOT } }
		}
	}
	can_end = {
		custom_trigger_tooltip = {
			tooltip = THE_MEL_performance_queen_character_disaster_c_tt1
			had_country_flag = {
				flag = THE_MEL_had_the_princess_character_performance_flag
				days = 18250
			}
		}
	}
	on_start_effect = {
		hidden_effect = {
			clr_country_flag = THE_MEL_having_the_performance_event_flag
			set_country_flag = THE_MEL_had_the_princess_character_performance_flag
			set_variable = {
				which = the_mel_won_war_number_once_var
				value = 0
			}
		}
		add_adm_power = 300
		add_dip_power = 300
		add_mil_power = 300
		hidden_effect = {
			change_variable = {
				which = the_mel_complete_princess_character_var
				value = 1
			}
			every_owned_province = {
				limit = {
					has_fort_building_trigger = yes
				}
				ROOT = {
					add_manpower = 5
				}
			}
			add_army_professionalism = 0.05
			if = {
				limit = {
					mission_completed = THE_MEL_2_3
				}
				for = {
					amount = 20
					effect = "
						random_owned_province = {
							limit = {
								NOT = { culture = ROOT }
							}
							change_culture = ROOT
						}
					"
				}
			}
		}
	}
	
	on_monthly = {
		
	}
	modifier = {
		stability_cost_modifier = -0.50
		build_cost = -0.15
		shock_damage_received = -0.10
	}
}

THE_MEL_performance_lover_character_disaster = {
	potential = {
		has_country_flag = THE_MEL_set_lover_character_performance_flag
	}
	can_start = {
		stability = 1
	}
	can_stop = {
		NOT = {
			stability = 1
		}
	}
	progress = {
		modifier = {
			factor = 0.5
			total_development = 250
		}
		modifier = {
			factor = 0.5
			total_development = 500
		}
		modifier = {
			factor = 0.5
			total_development = 1000
		}
		modifier = {
			factor = 0.25
			stability = 1
		}
		modifier = {
			factor = 0.25
			stability = 2
		}
		modifier = {
			factor = -100
			is_bankrupt = yes
		}
		modifier = {
			factor = -1
			NOT = { stability = 0 }
		}
		modifier = {
			factor = -1
			any_neighbor_province = {
				is_core = ROOT
			}
		}
		modifier = {
			factor = 1
			NOT = {
				any_neighbor_province = {
					is_core = ROOT
				}
			}
		}
		modifier = {
			factor = -1
			any_owned_province = {
				devastation = 1
			}
		}
		modifier = {
			factor = 0.25
			legitimacy = 90
		}
		modifier = {
			factor = -0.5
			NOT = {
				legitimacy = 80
			}
		}
		modifier = {
			factor = 0.25
			custom_trigger_tooltip = {
				tooltip = THE_MEL_performance_lover_character_disaster_trigger_c_tt1
				check_variable = {
					which = the_mel_owns_new_province_once_var
					value = 10
				}
			}
		}
		modifier = {
			factor = 0.25
			custom_trigger_tooltip = {
				tooltip = THE_MEL_performance_lover_character_disaster_trigger_c_tt2
				check_variable = {
					which = the_mel_owns_new_province_once_var
					value = 20
				}
			}
		}
		modifier = {
			factor = 0.25
			custom_trigger_tooltip = {
				tooltip = THE_MEL_performance_lover_character_disaster_trigger_c_tt3
				check_variable = {
					which = the_mel_owns_new_province_once_var
					value = 30
				}
			}
		}
		modifier = {
			factor = 0.5
			custom_trigger_tooltip = {
				tooltip = THE_MEL_performance_lover_character_disaster_trigger_c_tt4
				check_variable = {
					which = the_mel_owns_new_province_once_var
					value = 40
				}
			}
		}
		modifier = {
			factor = -1
			custom_trigger_tooltip = {
				tooltip = THE_MEL_performance_lover_character_disaster_trigger_c_tt5
				NOT = {
					check_variable = {
						which = the_mel_owns_new_province_once_var
						value = 5
					}
				}
			}
		}
	}
	can_end = {
		custom_trigger_tooltip = {
			tooltip = THE_MEL_had_the_lover_character_performance_flag
			had_country_flag = {
				flag = THE_MEL_had_the_queen_character_performance_flag
				days = 18250
			}
		}
	}
	on_monthly = {
		
	}
	on_start_effect = {
		hidden_effect = {
			clr_country_flag = THE_MEL_having_the_performance_event_flag
			set_country_flag = THE_MEL_had_the_lover_character_performance_flag
			set_variable = {
				which = the_mel_owns_new_province_once_var
				value = 0
			}
		}
		add_adm_power = 300
		add_dip_power = 300
		add_mil_power = 300
		hidden_effect = {
			change_variable = {
				which = the_mel_complete_lover_character_var
				value = 1
			}
			# change_variable = {
			# 	which = the_mel_complete_lover_character_owns_new_province_once_var
			# 	value = 1
			# }
			add_legitimacy = 10
			while = {
				limit = { 
					check_variable = {
						which = the_mel_owns_new_province_once_var
						value = 1
					}
				}
				every_country = {
					reverse_add_aggressive_expansion = {
						who = ROOT
						value = -1
					}
				}
				change_variable = {
					which = the_mel_owns_new_province_once_var
					value = -1
				}
			}
			if = {
				limit = {
					mission_completed = THE_MEL_4_3
				}
				every_neighbor_province = {
					area = {
						add_core = ROOT
					}
				}
			}
		}
	}
	on_end = THE_MEL_events.6
	modifier = {
		province_warscore_cost = -0.15
		diplomatic_annexation_cost = -0.25
		accept_vassalization_reasons = 20
	}
}

THE_MEL_performance_queen_character_disaster = {
	potential = {
		tag = MEL
		has_government_attribute = THE_MEL_sound_of_valley_lily_reform_mechanic
		has_country_flag = THE_MEL_set_queen_character_performance_flag
	}
	can_start = {
		stability = 1
	}
	can_stop = {
		NOT = {
			stability = 1
		}
	}
	progress = {
		modifier = {
			factor = 0.5
			total_development = 250
		}
		modifier = {
			factor = 0.5
			total_development = 500
		}
		modifier = {
			factor = 0.5
			total_development = 1000
		}
		modifier = {
			factor = 0.25
			stability = 1
		}
		modifier = {
			factor = 0.25
			stability = 2
		}
		modifier = {
			factor = 0.25
			stability = 3
		}
		modifier = {
			factor = 0.25
			prestige = 50
		}
		modifier = {
			factor = 0.25
			prestige = 100
		}
		modifier = {
			factor = -0.5
			any_owned_province = {
				devastation = 1
			}
		}
		modifier = {
			factor = -1
			overextension_percentage = 0.80
		}
		modifier = {
			factor = -100
			is_bankrupt = yes
		}
		modifier = {
			factor = -1
			NOT = { stability = 0 }
		}
		modifier = {
			factor = -0.5
			NOT = { prestige = 0 }
		}
		modifier = {
			factor = -0.5
			NOT = { prestige = -50 }
		}
	}
	can_end = {
		custom_trigger_tooltip = {
			tooltip = THE_MEL_performance_queen_character_disaster_c_tt1
			had_country_flag = {
				flag = THE_MEL_had_the_queen_character_performance_flag
				days = 18250
			}
		}
	}
	on_monthly = {
		
	}
	on_start_effect = {
		hidden_effect = {
			clr_country_flag = THE_MEL_having_the_performance_event_flag
			set_country_flag = THE_MEL_had_the_queen_character_performance_flag
		}
		add_adm_power = 300
		add_dip_power = 300
		add_mil_power = 300
		hidden_effect = {
			every_owned_province = {
				add_prosperity = 100
			}
			change_variable = {
				which = the_mel_complete_queen_character_var
				value = 1
			}
			if = {
				limit = { 
					mission_completed = THE_MEL_4_3
				}
				every_owned_province = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_territorial_core = ROOT }
					}
					add_territorial_core = ROOT
				}
				every_owned_province = {
					add_nationalism = -10
				}
			}
		}
	}
	on_end = THE_MEL_events.2
	modifier = {
		administrative_efficiency = 0.10
		prestige = 2
		global_tax_modifier = 0.20
	}
}

THE_MEL_performance_girl_character_disaster = {
	potential = {
		tag = MEL
		has_government_attribute = THE_MEL_sound_of_valley_lily_reform_mechanic
		has_country_flag = THE_MEL_set_girl_character_performance_flag
	}
	can_start = {
		stability = 1
	}
	can_stop = {
		NOT = {
			stability = 1
		}
	}
	progress = {
		modifier = {
			factor = 0.5
			total_development = 250
		}
		modifier = {
			factor = 0.5
			total_development = 500
		}
		modifier = {
			factor = 0.5
			total_development = 1000
		}
		modifier = {
			factor = 0.25
			stability = 1
		}
		modifier = {
			factor = 0.25
			stability = 2
		}
		modifier = {
			factor = 0.5
			custom_trigger_tooltip = {
				tooltip = THE_MEL_performance_girl_character_disaster_trigger_c_tt1
				check_variable = {
					which = the_mel_develop_the_province_once_var
					value = 10
				}
			}
		}
		modifier = {
			factor = 0.5
			custom_trigger_tooltip = {
				tooltip = THE_MEL_performance_girl_character_disaster_trigger_c_tt2
				check_variable = {
					which = the_mel_develop_the_province_once_var
					value = 20
				}
			}
		}
		modifier = {
			factor = 0.5
			custom_trigger_tooltip = {
				tooltip = THE_MEL_performance_girl_character_disaster_trigger_c_tt3
				check_variable = {
					which = the_mel_develop_the_province_once_var
					value = 30
				}
			}
		}
		modifier = {
			factor = -1
			custom_trigger_tooltip = {
				tooltip = THE_MEL_performance_girl_character_disaster_trigger_c_tt4
				check_variable = {
					which = the_mel_seige_defeat_once_var
					value = 10
				}
			}
		}
		modifier = {
			factor = -1
			custom_trigger_tooltip = {
				tooltip = THE_MEL_performance_girl_character_disaster_trigger_c_tt5
				check_variable = {
					which = the_mel_seige_defeat_once_var
					value = 20
				}
			}
		}
		modifier = {
			factor = -1
			custom_trigger_tooltip = {
				tooltip = THE_MEL_performance_girl_character_disaster_trigger_c_tt6
				check_variable = {
					which = the_mel_seige_defeat_once_var
					value = 30
				}
			}
		}
		modifier = {
			factor = -1
			custom_trigger_tooltip = {
				tooltip = THE_MEL_performance_girl_character_disaster_trigger_c_tt7
				NOT = {
					check_variable = {
						which = the_mel_develop_the_province_once_var
						value = 5
					}
				}
				
			}
		}
		modifier = {
			factor = -1
			any_owned_province = {
				devastation = 1
			}
		}
		modifier = {
			factor = -100
			is_bankrupt = yes
		}
		modifier = {
			factor = -1
			NOT = { stability = 0 }
		}
	}
	can_end = {
		custom_trigger_tooltip = {
			tooltip = THE_MEL_performance_queen_character_disaster_c_tt1
			had_country_flag = {
				flag = THE_MEL_had_the_girl_character_performance_flag
				days = 18250
			}
		}
	}
	on_monthly = {
		
	}
	on_start_effect = {
		hidden_effect = {
			clr_country_flag = THE_MEL_having_the_performance_event_flag
			set_country_flag = THE_MEL_had_the_girl_character_performance_flag
			set_variable = {
				which = the_mel_seige_defeat_once_var
				value = 0
			}
			set_variable = {
				which = the_mel_develop_the_province_once_var
				value = 0
			}
		}
		add_adm_power = 300
		add_dip_power = 300
		add_mil_power = 300
		hidden_effect = {
			change_variable = {
				which = the_mel_complete_girl_character_var
				value = 1
			}
			for = {
				amount = 20
				effect = "
					random_owned_province = {
						limit = {
							is_core = ROOT
						}
						add_base_production = 1
					}
				"
			}
			if = {
				limit = { 
					mission_completed = THE_MEL_5_3
				}
				add_years_of_owned_provinces_production_income = {
					years = 8
					custom_tooltip = MONOPOLY_INCOME_CLOTH_DESC
				}
			}
		}
	}
	on_end = THE_MEL_events.3
	modifier = {
		monthly_reform_progress_modifier = 0.10
		development_cost = -0.20
		build_cost = -0.15
		production_efficiency = 0.25
	}
}