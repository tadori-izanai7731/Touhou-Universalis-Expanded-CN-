THE_KEI_annex_ski_yac_province_in_war_effects = {
	if = {
		limit = {
			ROOT = {
				OR = {
					tag = KEI
					was_tag = KEI
				}
				has_country_modifier = THE_KEI_savtor_light_1_buff
				is_in_war = {
					attacker_leader = ROOT
				}
				FROM = {
					OR = {
						owned_by = SKI
						owned_by = YAC
						owned_by = GYK
					}
					is_capital = no
				}
			}
		 }
		 FROM = {
			cede_province = ROOT
			add_core = ROOT
			change_religion = ROOT
		 }
	}
}
#获得化生
the_kei_gain_effect_mechanic_power_1_effect = {
	if = {
		limit = {
			owner = {
				has_government_mechanic = THE_KEI_lonely_creation_mechanic
			}
		 }
		 owner = {
			add_government_power = {
				mechanic_type = THE_KEI_lonely_creation_mechanic
				power_type = THE_KEI_lonely_creation_mechanic_power
				value = $value$
			}
		}
	}
}
the_kei_gain_effect_mechanic_power_2_effect = {
	if = {
		limit = {
			ROOT = {
				has_government_mechanic = THE_KEI_lonely_creation_mechanic
			}
		 }
		 ROOT = {
			add_government_power = {
				mechanic_type = THE_KEI_lonely_creation_mechanic
				power_type = THE_KEI_lonely_creation_mechanic_power
				value = $value$
			}
		}
	}
}

##

THE_KEI_define_general_mayumi = {
	THE_KEI_define_general_mayumi_fire = yes
}

THE_KEI_define_general_mayumi_fire = {
	THE_KEI_define_general_mayumi_fire_script = { mayumi_fire = 0 }
	THE_KEI_define_general_mayumi_fire_script = { mayumi_fire = 1 }
	THE_KEI_define_general_mayumi_fire_script = { mayumi_fire = 2 }
	THE_KEI_define_general_mayumi_fire_script = { mayumi_fire = 3 }
	THE_KEI_define_general_mayumi_fire_script = { mayumi_fire = 4 }
	THE_KEI_define_general_mayumi_fire_script = { mayumi_fire = 5 }
	THE_KEI_define_general_mayumi_fire_script = { mayumi_fire = 6 }
	THE_KEI_define_general_mayumi_fire_script = { mayumi_fire = 7 }
	THE_KEI_define_general_mayumi_fire_script = { mayumi_fire = 8 }
}

THE_KEI_define_general_mayumi_fire_script = {
	if = {
		limit = {
			is_variable_equal = {
				which = the_mayumi_fire_var
				value = $mayumi_fire$
			}
		}
		THE_KEI_define_general_mayumi_shock = { mayumi_fire = $mayumi_fire$ }
	}
}

THE_KEI_define_general_mayumi_shock = {
	THE_KEI_define_general_mayumi_shock_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = 0 }
	THE_KEI_define_general_mayumi_shock_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = 1 }
	THE_KEI_define_general_mayumi_shock_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = 2 }
	THE_KEI_define_general_mayumi_shock_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = 3 }
	THE_KEI_define_general_mayumi_shock_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = 4 }
	THE_KEI_define_general_mayumi_shock_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = 5 }
	THE_KEI_define_general_mayumi_shock_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = 6 }
	THE_KEI_define_general_mayumi_shock_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = 7 }
	THE_KEI_define_general_mayumi_shock_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = 8 }
}

THE_KEI_define_general_mayumi_shock_script = {
	if = {
		limit = {
			is_variable_equal = {
				which = the_mayumi_shock_var
				value = $mayumi_shock$
			}
		}
		THE_KEI_define_general_mayumi_manuever = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ }
	}
}

THE_KEI_define_general_mayumi_manuever = {
	THE_KEI_define_general_mayumi_manuever_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = 0 }
	THE_KEI_define_general_mayumi_manuever_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = 1 }
	THE_KEI_define_general_mayumi_manuever_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = 2 }
	THE_KEI_define_general_mayumi_manuever_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = 3 }
	THE_KEI_define_general_mayumi_manuever_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = 4 }
	THE_KEI_define_general_mayumi_manuever_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = 5 }
	THE_KEI_define_general_mayumi_manuever_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = 6 }
	THE_KEI_define_general_mayumi_manuever_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = 7 }
	THE_KEI_define_general_mayumi_manuever_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = 8 }
}

THE_KEI_define_general_mayumi_manuever_script = {
	if = {
		limit = {
			is_variable_equal = {
				which = the_mayumi_manuever_var
				value = $mayumi_manuever$
			}
		}
		THE_KEI_define_general_mayumi_siege = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = $mayumi_manuever$ }
	}
}

THE_KEI_define_general_mayumi_siege = {
	THE_KEI_define_general_mayumi_siege_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = $mayumi_manuever$ mayumi_siege = 0 }
	THE_KEI_define_general_mayumi_siege_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = $mayumi_manuever$ mayumi_siege = 1 }
	THE_KEI_define_general_mayumi_siege_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = $mayumi_manuever$ mayumi_siege = 2 }
	THE_KEI_define_general_mayumi_siege_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = $mayumi_manuever$ mayumi_siege = 3 }
	THE_KEI_define_general_mayumi_siege_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = $mayumi_manuever$ mayumi_siege = 4 }
	THE_KEI_define_general_mayumi_siege_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = $mayumi_manuever$ mayumi_siege = 5 }
	THE_KEI_define_general_mayumi_siege_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = $mayumi_manuever$ mayumi_siege = 6 }
	THE_KEI_define_general_mayumi_siege_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = $mayumi_manuever$ mayumi_siege = 7 }
	THE_KEI_define_general_mayumi_siege_script = { mayumi_fire = $mayumi_fire$ mayumi_shock = $mayumi_shock$ mayumi_manuever = $mayumi_manuever$ mayumi_siege = 8 }
}

#耶尼切里计数
THE_KEI_amount_haniwa_recruit_effect = {
	owner = {
		change_variable = {
			which = the_kei_haniwa_recruit_im_var
			value = 1
		}
	}
}

#战斗胜利计数
THE_KEI_win_battle_count_1_effect = {
	if = {
		limit = { 
			FROM = {
				OR = {
					tag = KEI
					was_tag = KEI
				}
				has_country_modifier = THE_KEI_decree_sifang_buff
			}
		}
		change_variable = {
			which = the_kei_win_battle_count_im_var
			value = 1
		}
	}
}

THE_KEI_define_mayumi_set_var_0_effects = {
	set_variable = {
		which = the_mayumi_fire_var
		value = 0
	}
	set_variable = {
		which = the_mayumi_shock_var
		value = 0
	}
	set_variable = {
		which = the_mayumi_manuever_var
		value = 0
	}
	set_variable = {
		which = the_mayumi_siege_var
		value = 0
	}
	set_variable = {
		which = the_mayumi_define_var
		value = 0
	}
}
#清除所有敕命
THE_KEI_clr_all_decrese_buff_effects = {
	remove_country_modifier = THE_KEI_decree_sifang_buff
	remove_country_modifier = THE_KEI_decree_work_buff
	remove_country_modifier = THE_KEI_decree_work_V2_buff
	remove_country_modifier = THE_KEI_rejuvenate_buff
}

#清除所有「天工」flag
THE_KEI_clr_all_workman_flag_effects = {
	clr_country_flag = THE_KEI_workman_flag_trade
	clr_country_flag = THE_KEI_workman_flag_workshop
	clr_country_flag = THE_KEI_workman_flag_fort
	clr_country_flag = THE_KEI_workman_flag_barracks
	clr_country_flag = THE_KEI_workman_flag_camp
	clr_country_flag = THE_KEI_workman_flag_temple
	clr_country_flag = THE_KEI_workman_flag_court
	clr_country_flag = THE_KEI_workman_flag_university
}

#添加 救赎
THE_KEI_add_save_the_masses_power_effects = {
	if = {
		limit = { 
			FROM = {
				culture_group = Gensokyan_culture
			}
			KEI = {
				has_government_mechanic = THE_KEI_save_the_masses_government_mechanic
			}
		}
		KEI = {
			add_government_power = {
				mechanic_type = THE_KEI_save_the_masses_government_mechanic
				power_type = THE_KEI_masses_var_power
				value = 2
			}
		}
	}
}