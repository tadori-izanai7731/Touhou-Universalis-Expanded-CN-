##定义探索目标 初始化
THE_IQU_define_expedition_target_effects = {
	# random_owned_province = {
	# 	limit = {
	# 		has_province_flag = THE_IQU_province_unique_point_flag
	# 		NOT = {
	# 			has_province_flag = THE_IQU_had_saved_unique_point_flag
	# 		}
	# 	}
	# 	save_event_target_as = THE_IQU_province_unique_1_target
	# 	set_province_flag = THE_IQU_had_saved_unique_point_flag
	# }
	# random_owned_province = {
	# 	limit = {
	# 		has_province_flag = THE_IQU_province_unique_point_flag
	# 		NOT = {
	# 			has_province_flag = THE_IQU_had_saved_unique_point_flag
	# 		}
	# 	}
	# 	save_event_target_as = THE_IQU_province_unique_2_target
	# 	set_province_flag = THE_IQU_had_saved_unique_point_flag
	# }
	# random_owned_province = {
	# 	limit = {
	# 		has_province_flag = THE_IQU_province_unique_point_flag
	# 		NOT = {
	# 			has_province_flag = THE_IQU_had_saved_unique_point_flag
	# 		}
	# 	}
	# 	save_event_target_as = THE_IQU_province_unique_3_target
	# 	set_province_flag = THE_IQU_had_saved_unique_point_flag
	# }
	# random_owned_province = {
	# 	limit = {
	# 		has_province_flag = THE_IQU_province_unique_point_flag
	# 		NOT = {
	# 			has_province_flag = THE_IQU_had_saved_unique_point_flag
	# 		}
	# 	}
	# 	save_event_target_as = THE_IQU_province_unique_4_target
	# 	set_province_flag = THE_IQU_had_saved_unique_point_flag
	# }
	THE_IQU_define_exploring_target_script_1_effects = {
		number = 1
	}
	THE_IQU_define_exploring_target_script_1_effects = {
		number = 2
	}
	THE_IQU_define_exploring_target_script_1_effects = {
		number = 3
	}
	THE_IQU_define_exploring_target_script_1_effects = {
		number = 4
	}
	THE_IQU_define_exploring_target_script_1_effects = {
		number = 5
	}
	THE_IQU_define_exploring_target_script_1_effects = {
		number = 6
	}
	THE_IQU_define_exploring_target_script_1_effects = {
		number = 7
	}
	THE_IQU_define_exploring_target_script_1_effects = {
		number = 8
	}
	THE_IQU_define_exploring_target_script_1_effects = {
		number = 9
	}
	THE_IQU_define_exploring_target_script_1_effects = {
		number = 10
	}
	THE_IQU_define_exploring_target_script_1_effects = {
		number = 11
	}
	THE_IQU_define_exploring_target_script_1_effects = {
		number = 12
	}
}
#设定事件目标
THE_IQU_define_exploring_target_script_1_effects = {
	random_owned_province = {
		limit = {
			has_province_flag = THE_IQU_province_unique_point_flag
			NOT = {
				has_province_flag = THE_IQU_had_saved_unique_point_flag
			}
		}
		save_event_target_as = THE_IQU_province_unique_$number$_target
		set_province_flag = THE_IQU_had_saved_unique_point_flag
	}
}

##设定 （异常点）
THE_IQU_add_unique_point_temporary_province_effects = {
	hidden_effect = {
		set_province_flag = THE_IQU_province_unique_point_flag
		#Set DIFFICULT
		set_province_flag = THE_IQU_province_explore_lvl_$level$_flag
	}
	custom_tooltip = THE_IQU_unique_set_temporary_point_c_tt1
	############
	# hidden_effect = {
	# 	random_owned_province = {
	# 		limit = {
	# 			area = $area$
	# 		}
	# 		set_province_flag = THE_IQU_province_unique_point_flag
	# 		#DIFFICULT
	# 		set_province_flag = THE_IQU_province_explore_lvl_$level$_flag
	# 	}
	# }
	# $area$ = {
	# 	custom_tooltip = THE_IQU_unique_set_temporary_point_c_tt1
	# }	
}

##初始化--将要添加危险度，和探险进度
THE_IQU_add_explore_progress_or_dangerous_progress_effects_before = {
	hidden_effect = {
		set_variable = {
			which = the_iqu_will_change_explore_progress
			value = $explore$
		}
		set_variable = {
			which = the_iqu_will_change_danger_progress
			value = $danger$
		}
		THE_IQU_read_the_province_difficult_to_progress_script = yes
	}
}
#读取探险难度进行修正
THE_IQU_read_the_province_difficult_to_progress_script = {
	any_owned_province = {
		limit = {
			has_province_flag = THE_IQU_this_provinces_is_exploring_now
		}
		save_event_target_as = THE_IQU_province_difficult_correct_target
	}
	# if = {
	# 	limit = {
	# 		any_owned_province = {
	# 			has_province_flag = THE_IQU_this_provinces_is_exploring_now
	# 		}
	# 	}
	# 	random_owned_province = {
	# 		limit = {
	# 			has_province_flag = THE_IQU_this_provinces_is_exploring_now
	# 		}
	# 		save_event_target_as = THE_IQU_province_difficult_correct_target
	# 	}
	# }
	# else_if = {
	# 	limit = {
	# 		any_subject_country = {
	# 			any_owned_province = {
	# 				has_province_flag = THE_IQU_this_provinces_is_exploring_now
	# 			}
	# 		}
	# 	}
	# 	random_subject_country = {
	# 		limit = {
	# 			any_owned_province = {
	# 				has_province_flag = THE_IQU_this_provinces_is_exploring_now
	# 			}
	# 		}
	# 		random_owned_province = {
	# 			limit = {
	# 				has_province_flag = THE_IQU_this_provinces_is_exploring_now
	# 			}
	# 			save_event_target_as = THE_IQU_province_difficult_correct_target
	# 		}
	# 	}
	# }
	if = { limit = { event_target:THE_IQU_province_difficult_correct_target = { has_province_flag = THE_IQU_province_explore_lvl_1_flag } } subtract_variable = { which = the_iqu_will_change_explore_progress value = 2.0 } subtract_variable = { which = the_iqu_will_change_danger_progress value = 0.5 } }
	else_if = { limit = { event_target:THE_IQU_province_difficult_correct_target = { has_province_flag = THE_IQU_province_explore_lvl_2_flag } } subtract_variable = { which = the_iqu_will_change_explore_progress value = 1.5 } subtract_variable = { which = the_iqu_will_change_danger_progress value = 0.7 } }
	else_if = { limit = { event_target:THE_IQU_province_difficult_correct_target = { has_province_flag = THE_IQU_province_explore_lvl_3_flag } } subtract_variable = { which = the_iqu_will_change_explore_progress value = 1.0 } subtract_variable = { which = the_iqu_will_change_danger_progress value = 1.0 } }
	else_if = { limit = { event_target:THE_IQU_province_difficult_correct_target = { has_province_flag = THE_IQU_province_explore_lvl_4_flag } } subtract_variable = { which = the_iqu_will_change_explore_progress value = 0.9 } subtract_variable = { which = the_iqu_will_change_danger_progress value = 1.5 } }
	else_if = { limit = { event_target:THE_IQU_province_difficult_correct_target = { has_province_flag = THE_IQU_province_explore_lvl_5_flag } } subtract_variable = { which = the_iqu_will_change_explore_progress value = 0.7 } subtract_variable = { which = the_iqu_will_change_danger_progress value = 1.8 } }
}

THE_IQU_add_explore_progress_or_dangerous_progress_effects = {
	#改变将会改变的进度
	hidden_effect = {
		#改变
		change_variable = {
			which = the_iqu_now_explore_progress
			which = the_iqu_will_change_explore_progress
		}
		change_variable = {
			which = the_iqu_now_danger_progress
			which = the_iqu_will_change_danger_progress
		}
	}
	custom_tooltip = THE_IQU_add_explore_progress_or_dangerous_progres_c_tt1
	##可视化当前探险进度&危险进度
	custom_tooltip = THE_IQU_now_explore_progress_view_c_tt_x
	custom_tooltip = THE_IQU_now_dangerous_progres_view_c_tt_x
	hidden_effect = {
		THE_IQU_on_check_the_progress_event_effect = yes
	}
}
#月球探索探险进度 无视danger
THE_IQU_add_explore_progress_or_dangerous_progress_effects_before_on_moon_once = {
	hidden_effect = {
		set_variable = {
			which = the_iqu_will_change_explore_progress
			value = $explore$
		}
		set_variable = {
			which = the_iqu_will_change_danger_progress
			value = $danger$
		}
	}
}
#月球探索探险进度 无视danger
THE_IQU_add_explore_progress_or_dangerous_progress_effects_on_moon_once = {
	#改变将会改变的进度
	hidden_effect = {
		#改变
		change_variable = {
			which = the_iqu_now_explore_progress
			which = the_iqu_will_change_explore_progress
		}
		change_variable = {
			which = the_iqu_now_danger_progress
			which = the_iqu_will_change_danger_progress
		}
	}
	custom_tooltip = THE_IQU_add_explore_progress_or_dangerous_progres_c_tt1
	##可视化当前探险进度&危险进度
	custom_tooltip = THE_IQU_now_explore_progress_view_c_tt_x
	custom_tooltip = THE_IQU_now_dangerous_progres_view_c_tt_x
}


##探险初始化数值
THE_IQU_on_start_the_explore_event_effects = {
	hidden_effect = {
		set_variable = {
			which = the_iqu_now_explore_progress
			value = 0
		}
		set_variable = {
			which = the_iqu_now_danger_progress
			value = 0
		}
		##
	}
}

##检测探险度是否完成or失败
THE_IQU_on_check_the_progress_event_effect = {
	hidden_effect = {
		if = {
			limit = { 
				check_variable = {
					which = the_iqu_now_explore_progress
					value = 100
				}
			}
			###触发成功事件
			country_event = {
				id = THE_IQU_flavor_events.1000
			}
		}
		else_if = {
			limit = {
				check_variable = {
					which = the_iqu_now_danger_progress
					value = 100
				}
			}
			###触发失败事件
			country_event = {
				id = THE_IQU_flavor_events.1001
			}
		}
	}
}

##奖励结算-IMMEDIATE
THE_IQU_explore_event_get_benifit_immeditate_script = {
	hidden_effect = {
		random_owned_province = {
			limit = {
				has_province_flag = THE_IQU_this_provinces_is_exploring_now
			}
			save_event_target_as = THE_IQU_province_difficult_about_treasury_target
		}
		set_variable = {
			which = the_iqu_base_treasury_im_var
			value = $base$
		}
		if = { limit = { event_target:THE_IQU_province_difficult_about_treasury_target = { has_province_flag = THE_IQU_province_explore_lvl_1_flag } } subtract_variable = { which = the_iqu_base_treasury_im_var value = 0.6 } }
		else_if = { limit = { event_target:THE_IQU_province_difficult_about_treasury_target = { has_province_flag = THE_IQU_province_explore_lvl_2_flag } } subtract_variable = { which = the_iqu_base_treasury_im_var value = 0.8 } }
		else_if = { limit = { event_target:THE_IQU_province_difficult_about_treasury_target = { has_province_flag = THE_IQU_province_explore_lvl_3_flag } } subtract_variable = { which = the_iqu_base_treasury_im_var value = 1.0 } }
		else_if = { limit = { event_target:THE_IQU_province_difficult_about_treasury_target = { has_province_flag = THE_IQU_province_explore_lvl_4_flag } } subtract_variable = { which = the_iqu_base_treasury_im_var value = 1.2 } }
		else_if = { limit = { event_target:THE_IQU_province_difficult_about_treasury_target = { has_province_flag = THE_IQU_province_explore_lvl_5_flag } } subtract_variable = { which = the_iqu_base_treasury_im_var value = 1.4 } }
		##设置金钱奖励
		set_variable = {
			which = the_iqu_base_treasury_gold_im_var
			which = the_iqu_base_treasury_im_var
		}
		multiply_variable = {
			which = the_iqu_base_treasury_gold_im_var
			value = 5
		}
		#导出奖励修正
		export_to_variable = {
			which = the_iqu_treasury_get_modifier_im_var
			value = modifier:THE_IQU_explore_treasury_get_cutom_modifier
		}
		change_variable = {
			which = the_iqu_treasury_get_modifier_im_var
			value = 1
		}
		subtract_variable = {
			which = the_iqu_base_treasury_im_var
			which = the_iqu_treasury_get_modifier_im_var
		}	
	}
	## 点数奖励变量 the_iqu_base_treasury_im_var
	## 金钱奖励变量 the_iqu_base_treasury_gold_im_var
}
##奖励获取—Effect
THE_IQU_explore_event_get_benifit_effect_effect = {
	#本地化
	custom_tooltip = THE_IQU_explore_get_treasury_point_c_tt1
	hidden_effect = {
		while = {
			limit = { 
				check_variable = {
					which = the_iqu_base_treasury_im_var
					value = 1
				}
			}
			add_adm_power = 1
			add_dip_power = 1
			add_mil_power = 1
			change_variable = {
				which = the_iqu_base_treasury_im_var
				value = -1
			}
		}
		while = {
			limit = { 
				check_variable = {
					which = the_iqu_base_treasury_gold_im_var
					value = 1
				}
			}
			add_treasury = 1
			change_variable = {
				which = the_iqu_base_treasury_gold_im_var
				value = -1
			}
		}
	}
}
##更新「航海经验」变量 the_iqu_nautical_experience_change_im_var
##检测「航海经验」更改触发概率脚本
THE_IQU_check_nautical_experience_change_event_random_effects = {
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 10 } } random_list = { 80 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 20 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 9 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 10 } } } random_list = { 75 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 25 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 8 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 9 } } } random_list = { 70 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 30 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 7 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 8 } } } random_list = { 65 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 35 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 6 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 7 } } } random_list = { 55 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 40 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 5 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 6 } } } random_list = { 50 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 45 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 4 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 5 } } } random_list = { 45 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 50 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 3 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 4 } } } random_list = { 40 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 55 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 2 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 3 } } } random_list = { 35 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 60 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 1 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 2 } } } random_list = { 30 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 65 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 0 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 1 } } } random_list = { 25 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 70 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_c_tt1
}

##更新「才学经验」变量 the_iqu_learning_experience_change_im_var
##检测「才学经验」更改触发概率脚本
THE_IQU_check_learning_experience_change_event_random_effects = {
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 10 } } random_list = { 80 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 20 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 9 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 10 } } } random_list = { 75 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 25 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 8 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 9 } } } random_list = { 70 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 30 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 7 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 8 } } } random_list = { 65 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 35 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 6 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 7 } } } random_list = { 55 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 40 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 5 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 6 } } } random_list = { 50 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 45 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 4 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 5 } } } random_list = { 45 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 50 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 3 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 4 } } } random_list = { 40 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 55 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 2 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 3 } } } random_list = { 35 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 60 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 1 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 2 } } } random_list = { 30 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 65 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 0 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 1 } } } random_list = { 25 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 70 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	custom_tooltip = THE_IQU_check_learning_experience_change_event_effect_c_tt1
}
##更新「外交经验」变量 the_iqu_diplomacal_experience_change_im_var
##检测「外交经验」更改触发概率脚本
THE_IQU_check_diplomacal_experience_change_event_random_effects = {
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 10 } } random_list = { 80 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 20 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 9 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 10 } } } random_list = { 75 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 25 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 8 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 9 } } } random_list = { 70 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 30 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 7 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 8 } } } random_list = { 65 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 35 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 6 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 7 } } } random_list = { 55 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 40 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 5 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 6 } } } random_list = { 50 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 45 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 4 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 5 } } } random_list = { 45 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 50 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 3 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 4 } } } random_list = { 40 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 55 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 2 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 3 } } } random_list = { 35 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 60 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 1 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 2 } } } random_list = { 30 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 65 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 0 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 1 } } } random_list = { 25 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 70 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	custom_tooltip = THE_IQU_check_diplomacal_experience_change_event_effect_c_tt1
}
##检测 触发「一般」事件
THE_IQU_check_none_normal_change_event_random_effects = {
	hidden_effect = {
		country_event = {
			id = $ne_id$
			days = 2
		}
	}
	custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt3
}
##检测 触发「成功」事件
THE_IQU_check_none_success_change_event_random_effects = {
	hidden_effect = {
		country_event = {
			id = $better_id$
			days = 2
		}
	}
	custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1
}
##检测 触发「失败」事件
THE_IQU_check_none_fail_change_event_random_effects = {
	hidden_effect = {
		country_event = {
			id = $bad_id$
			days = 2
		}
	}
	custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2
}
##「成功」的事件清除
THE_IQU_clr_the_exploring_now_success_effect = {
	hidden_effect = {
		# every_subject_country = {
		# 	random_owned_province = {
		# 		limit = {
		# 			has_province_flag = THE_IQU_this_provinces_is_exploring_now
		# 		}
		# 		#清除难度 flag
		# 		clr_province_flag = THE_IQU_province_explore_lvl_1_flag
		# 		clr_province_flag = THE_IQU_province_explore_lvl_2_flag
		# 		clr_province_flag = THE_IQU_province_explore_lvl_3_flag
		# 		clr_province_flag = THE_IQU_province_explore_lvl_4_flag
		# 		clr_province_flag = THE_IQU_province_explore_lvl_5_flag
		# 		#清除异常点
		# 		clr_province_flag = THE_IQU_province_unique_point_flag
		# 		#设立完成标记
		# 		set_province_flag = THE_IQU_this_province_had_been_explored_flag
		# 		THE_IQU_add_fengshui_wuxing_province_permant_buff_effect = yes 
		
		# 		#满足政体添加龙脉
		# 		if = {
		# 			limit = {
		# 				has_government_attribute = THE_IQU_scarlet_sky_reform_mechanic
		# 			}
		# 			random_list = {
		# 				25 = {
		# 					add_permanent_province_modifier = {
		# 						name = THE_IQU_lonng_vein_head_province_buff
		# 						duration = -1
		# 					}
		# 				}
		# 			}
		# 		}
		
		# 		#清除正在探索
		# 		clr_province_flag = THE_IQU_this_provinces_is_exploring_now
		# 	}
		# }
		random_owned_province = {
			limit = {
				has_province_flag = THE_IQU_this_provinces_is_exploring_now
			}
			#清除难度 flag
			clr_province_flag = THE_IQU_province_explore_lvl_1_flag
			clr_province_flag = THE_IQU_province_explore_lvl_2_flag
			clr_province_flag = THE_IQU_province_explore_lvl_3_flag
			clr_province_flag = THE_IQU_province_explore_lvl_4_flag
			clr_province_flag = THE_IQU_province_explore_lvl_5_flag
			#清除异常点
			clr_province_flag = THE_IQU_province_unique_point_flag
			#设立完成标记
			set_province_flag = THE_IQU_this_province_had_been_explored_flag
			THE_IQU_add_fengshui_wuxing_province_permant_buff_effect = yes 
			
			#满足政体添加龙脉
			if = {
				limit = {
					has_government_attribute = THE_IQU_scarlet_sky_reform_mechanic
				}
				random_list = {
					25 = {
						add_permanent_province_modifier = {
							name = THE_IQU_lonng_vein_head_province_buff
							duration = -1
						}
					}
				}
			}
			
			#清除正在探索
			clr_province_flag = THE_IQU_this_provinces_is_exploring_now
		}
		#国家作用域
		#清除正在探索
		clr_country_flag = THE_IQU_now_is_exploring_flag
		##事件持有清除
		clr_country_flag = THE_IQU_had_explore_event
		clr_country_flag = THE_IQU_having_explore_event
		#已经探索的地区获取
		change_variable = {
			which = the_iqu_had_explore_area_number_im_var
			value = 1
		}
	}
}
## 添加风水五行之期
THE_IQU_add_fengshui_wuxing_province_permant_buff_effect = {
	owner = {
		change_variable = {
			which = the_iqu_add_fengshui_wuxing_province_number_var
			value = 1
		}
	}
	if = {
		limit = {
			mission_completed = THE_IQU_2_5
		}
		change_trade_goods = paper
	}
	if = {
		limit = {
			owner = {
				check_variable = {
					which = the_iqu_add_fengshui_wuxing_province_number_var
					value = 5
				}
				
			}
		}
		add_permanent_province_modifier = {
			name = THE_IQU_Feng_shui_jin_buff
			duration = -1  
		}
		owner = {
			set_variable = {
				which = the_iqu_add_fengshui_wuxing_province_number_var
				value = 0
			}
		}
	}
	else_if = {
		limit = {
			owner = {
				check_variable = {
					which = the_iqu_add_fengshui_wuxing_province_number_var
					value = 4
				}
			}
		}
		add_permanent_province_modifier = {
			name = THE_IQU_Feng_shui_shui_buff
			duration = -1  
		}
	}
	else_if = {
		limit = {
			owner = {
				check_variable = {
					which = the_iqu_add_fengshui_wuxing_province_number_var
					value = 3
				}
			}
		}
		add_permanent_province_modifier = {
			name = THE_IQU_Feng_shui_mu_buff
			duration = -1  
		}
	}
	else_if = {
		limit = {
			owner = {
				check_variable = {
					which = the_iqu_add_fengshui_wuxing_province_number_var
					value = 2
				}
			}
		}
		add_permanent_province_modifier = {
			name = THE_IQU_Feng_shui_huo_buff
			duration = -1  
		}
	}
	else_if = {
		limit = {
			owner = {
				check_variable = {
					which = the_iqu_add_fengshui_wuxing_province_number_var
					value = 1
				}
			}
		}
		add_permanent_province_modifier = {
			name = THE_IQU_Feng_shui_tu_buff
			duration = -1  
		}
	}
	# if = {
	# 	limit = {
	# 		ROOT = {
	# 			region = {
	# 				type = all
	# 				NOT = { has_province_modifier = THE_IQU_Feng_shui_jin_buff }
	# 				NOT = { has_province_modifier = THE_IQU_Feng_shui_shui_buff }
	# 				NOT = { has_province_modifier = THE_IQU_Feng_shui_mu_buff }
	# 				NOT = { has_province_modifier = THE_IQU_Feng_shui_huo_buff }
	# 				NOT = { has_province_modifier = THE_IQU_Feng_shui_tu_buff }
	# 			}
	# 		}
	# 	}
	# 	if = {
	# 		limit = {
	# 			THE_IQU_check_province_modifier_trigger = {
	# 				modifier = THE_IQU_Feng_shui_jin_buff
	# 			}
	# 		}
	# 		add_permanent_province_modifier = {
	# 			name = THE_IQU_Feng_shui_jin_buff
	# 			duration = -1  
	# 		}
	# 	}
	# 	else_if = {
	# 		limit = {
	# 			THE_IQU_check_province_modifier_trigger = {
	# 				modifier = THE_IQU_Feng_shui_shui_buff
	# 			}
	# 		}
	# 		add_permanent_province_modifier = {
	# 			name = THE_IQU_Feng_shui_shui_buff
	# 			duration = -1  
	# 		}
	# 	}
	# 	else_if = {
	# 		limit = {
	# 			THE_IQU_check_province_modifier_trigger = {
	# 				modifier = THE_IQU_Feng_shui_mu_buff
	# 			}
	# 		}
	# 		add_permanent_province_modifier = {
	# 			name = THE_IQU_Feng_shui_mu_buff
	# 			duration = -1  
	# 		}
	# 	}
	# 	else_if = {
	# 		limit = {
	# 			THE_IQU_check_province_modifier_trigger = {
	# 				modifier = THE_IQU_Feng_shui_huo_buff
	# 			}
	# 		}
	# 		add_permanent_province_modifier = {
	# 			name = THE_IQU_Feng_shui_huo_buff
	# 			duration = -1  
	# 		}
	# 	}
	# 	else_if = {
	# 		limit = {
	# 			THE_IQU_check_province_modifier_trigger = {
	# 				modifier = THE_IQU_Feng_shui_tu_buff
	# 			}
	# 		}
	# 		add_permanent_province_modifier = {
	# 			name = THE_IQU_Feng_shui_tu_buff
	# 			duration = -1  
	# 		}
	# 	}
	# 	else = {
	# 		random_list = {
	# 			20 = {
	# 				add_permanent_province_modifier = {
	# 					name = THE_IQU_Feng_shui_jin_buff
	# 					duration = -1  
	# 				}
	# 			}
	# 			20 = {
	# 				add_permanent_province_modifier = {
	# 					name = THE_IQU_Feng_shui_shui_buff
	# 					duration = -1  
	# 				}
	# 			}
	# 			20 = {
	# 				add_permanent_province_modifier = {
	# 					name = THE_IQU_Feng_shui_mu_buff
	# 					duration = -1  
	# 				}
	# 			}
	# 			20 = {
	# 				add_permanent_province_modifier = {
	# 					name = THE_IQU_Feng_shui_huo_buff
	# 					duration = -1  
	# 				}
	# 			}
	# 			20 = {
	# 				add_permanent_province_modifier = {
	# 					name = THE_IQU_Feng_shui_tu_buff
	# 					duration = -1  
	# 				}
	# 			}
	# 		}
	# 	}
	
	# }
}
#「失败」的事件清除
THE_IQU_clr_the_exploring_now_fail_effect = {
	hidden_effect = {
		# OR = {
		# 	random_owned_province = {
		# 		limit = {
		# 			has_province_flag = THE_IQU_this_provinces_is_exploring_now
		# 		}
		# 		clr_province_flag = THE_IQU_this_provinces_is_exploring_now
		# 	}
		# 	every_subject_country = {
		# 		limit = {
		# 			any_owned_province = {
		# 				has_province_flag = THE_IQU_this_provinces_is_exploring_now
		# 			}
		# 		}
		# 		random_owned_province = {
		# 			limit = {
		# 				has_province_flag = THE_IQU_this_provinces_is_exploring_now
		# 			}
		# 			clr_province_flag = THE_IQU_this_provinces_is_exploring_now
		# 		}
		# 	}
		# }
		random_owned_province = {
			limit = {
				has_province_flag = THE_IQU_this_provinces_is_exploring_now
			}
			clr_province_flag = THE_IQU_this_provinces_is_exploring_now
		}
		clr_country_flag = THE_IQU_now_is_exploring_flag
		##事件持有清除
		clr_country_flag = THE_IQU_had_explore_event
		clr_country_flag = THE_IQU_having_explore_event
	}
}
# 添加 威望 溢出转化
THE_IQU_add_prestige_or_navy_tradition_effects = {
	tooltip = {
		add_prestige = $value$
		custom_tooltip = THE_IQU_add_prestige_or_navy_tradition_c_tt1
	}
	hidden_effect = {
		for = {
			amount = $value$
			effect = "
				if = {
					limit = { 
						NOT = {
							prestige = 100
						}
					}
					add_prestige = 1
				}
				else = {
					add_navy_tradition = 0.5
				}
			"
		}
	}
}
# 引导龙脉添加建筑
THE_IQU_guide_the_lonng_vein_custom_gui_script = {
	custom_tooltip = THE_IQU_guide_the_loong_vein_building_construction_scripted_c_tt1
	hidden_effect = {
		export_to_variable = {
			variable_name = the_iqu_guide_loong_vein_export_im_var
			value = modifier:THE_IQU_guide_loong_vein_custom_modifier
		}
		multiply_variable = {
			which = the_iqu_guide_loong_vein_export_im_var
			value = -10
		}
		# set_variable = {
		# 	which = the_iqu_base_guide_loong_vein_building_time_im_var
		# 	value = 1
		# }
		# change_variable = {
		# 	which = the_iqu_base_guide_loong_vein_building_time_im_var
		# 	which = the_iqu_guide_loong_vein_export_im_var
		# }
	}
	if = { limit = { check_variable = { which = the_iqu_guide_loong_vein_export_im_var value = -1 } } add_building_construction = { building = THE_IQU_guide_the_loong_vein_building cost = 1.0 speed = 0.9 } }
	else_if = { limit = { check_variable = { which = the_iqu_guide_loong_vein_export_im_var value = -2 } } add_building_construction = { building = THE_IQU_guide_the_loong_vein_building cost = 1.0 speed = 0.8 } }
	else_if = { limit = { check_variable = { which = the_iqu_guide_loong_vein_export_im_var value = -3 } } add_building_construction = { building = THE_IQU_guide_the_loong_vein_building cost = 1.0 speed = 0.7 } }
	else_if = { limit = { check_variable = { which = the_iqu_guide_loong_vein_export_im_var value = -4 } } add_building_construction = { building = THE_IQU_guide_the_loong_vein_building cost = 1.0 speed = 0.6 } }
	else_if = { limit = { check_variable = { which = the_iqu_guide_loong_vein_export_im_var value = -5 } } add_building_construction = { building = THE_IQU_guide_the_loong_vein_building cost = 1.0 speed = 0.5 } }
	else_if = { limit = { check_variable = { which = the_iqu_guide_loong_vein_export_im_var value = -6 } } add_building_construction = { building = THE_IQU_guide_the_loong_vein_building cost = 1.0 speed = 0.4 } }
	else_if = { limit = { check_variable = { which = the_iqu_guide_loong_vein_export_im_var value = -7 } } add_building_construction = { building = THE_IQU_guide_the_loong_vein_building cost = 1.0 speed = 0.3 } }
	else_if = { limit = { check_variable = { which = the_iqu_guide_loong_vein_export_im_var value = -8 } } add_building_construction = { building = THE_IQU_guide_the_loong_vein_building cost = 1.0 speed = 0.2 } }
	else_if = { limit = { check_variable = { which = the_iqu_guide_loong_vein_export_im_var value = -9 } } add_building_construction = { building = THE_IQU_guide_the_loong_vein_building cost = 1.0 speed = 0.1 } }
}
#建筑效果
THE_IQU_guide_the_loong_vein_building_construction_scripted = {
	hidden_effect = {
		if = {
			limit = { 
				any_neighbor_province = {
					has_province_modifier = THE_IQU_lonng_vein_head_province_buff
				}
			}
			random_neighbor_province = {
				limit = {
					has_province_modifier = THE_IQU_lonng_vein_head_province_buff
				}
				remove_province_modifier = THE_IQU_lonng_vein_head_province_buff
				add_province_modifier = {
					name = THE_IQU_lonng_vein_foot_province_buff
					duration = 7300
				}
				THE_IQU_move_wuxing_loong_province_flag_effect = yes
			}
		}
		else = {
			sea_zone = {
				random_neighbor_province = {
					limit = {
						has_province_modifier = THE_IQU_lonng_vein_head_province_buff
					}
					remove_province_modifier = THE_IQU_lonng_vein_head_province_buff
					add_province_modifier = {
						name = THE_IQU_lonng_vein_foot_province_buff
						duration = 7300
					}
					THE_IQU_move_wuxing_loong_province_flag_effect = yes
				}	
			}
		}
		add_permanent_province_modifier = {
			name = THE_IQU_lonng_vein_head_province_buff
			duration = -1
		}
		### 特殊任务效果
		if = {
			limit = {
				OR = {
					owner = {
						tag = IQU
						mission_completed = THE_IQU_3_8
					}
					overlord = {
						tag = IQU
						mission_completed = THE_IQU_3_8
					}
				} 
			}
			every_neighbor_province = {
				add_colonysize = 100
				change_native_size = 4000
				change_native_ferocity = -2
				change_native_hostileness = -2
			}
		}
		###############
		if = {
			limit = {
				has_terrain = jungle
			}
			IQU = {
				change_variable = {
					which = the_iqu_jungle_province_has_been_teer_im_var
					value = 1
				}
			}
		}
		if = {
			limit = {
				has_terrain = mountain
			}
			IQU = {
				change_variable = {
					which = the_iqu_mountain_province_has_been_teer_im_var
					value = 1
				}
			}
		}
		###
		THE_IQU_will_check_province_fengshui_and_add_next_flag_effect = yes
	}
}
#建筑检测 当地风水，获得flag以及下一期五行
# THE_IQU_loong_vein_get_wuxing_jin_flag 已获得五行-金
# THE_IQU_loong_vein_get_wuxing_shui_flag 已获得五行-水
# THE_IQU_loong_vein_get_wuxing_mu_flag 已获得五行-木
# THE_IQU_loong_vein_get_wuxing_huo_flag 已获得五行-火
# THE_IQU_loong_vein_get_wuxing_tu_flag 已获得五行-土

####
# THE_IQU_loong_vein_get_wuxing_jin_flag_next 下一期-金
# THE_IQU_loong_vein_get_wuxing_shui_flag_next 下一期-水
# THE_IQU_loong_vein_get_wuxing_mu_flag_next 下一期-木
# THE_IQU_loong_vein_get_wuxing_huo_flag_next 下一期-火
# THE_IQU_loong_vein_get_wuxing_tu_flag_next 下一期-土
THE_IQU_will_check_province_fengshui_and_add_next_flag_effect = {
	THE_IQU_will_check_province_fengshui_and_add_next_flag_script = { wuxing = jin next = shui }
	THE_IQU_will_check_province_fengshui_and_add_next_flag_script = { wuxing = shui next = mu }
	THE_IQU_will_check_province_fengshui_and_add_next_flag_script = { wuxing = mu next = huo }
	THE_IQU_will_check_province_fengshui_and_add_next_flag_script = { wuxing = huo next = tu }
	THE_IQU_will_check_province_fengshui_and_add_next_flag_script = { wuxing = tu next = jin }
}
THE_IQU_will_check_province_fengshui_and_add_next_flag_script = {
	if = {
		limit = { 
			has_province_modifier = THE_IQU_Feng_shui_$wuxing$_buff
			OR = {
				has_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag_next
				AND = {
					NOT = { has_country_flag = THE_IQU_loong_vein_get_wuxing_jin_flag_next }
					NOT = { has_country_flag = THE_IQU_loong_vein_get_wuxing_shui_flag_next }
					NOT = { has_country_flag = THE_IQU_loong_vein_get_wuxing_mu_flag_next }
					NOT = { has_country_flag = THE_IQU_loong_vein_get_wuxing_huo_flag_next }
					NOT = { has_country_flag = THE_IQU_loong_vein_get_wuxing_tu_flag_next }
				}
			}
			
		}
		THE_IQU_will_clr_all_next_wuxing_province_flag_effect = yes
		set_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag
		set_province_flag = THE_IQU_loong_vein_get_wuxing_$next$_flag_next
	}
}
#清除所有下一期五行标签
THE_IQU_will_clr_all_next_wuxing_province_flag_effect = {
	clr_province_flag = THE_IQU_loong_vein_get_wuxing_jin_flag_next
	clr_province_flag = THE_IQU_loong_vein_get_wuxing_shui_flag_next
	clr_province_flag = THE_IQU_loong_vein_get_wuxing_mu_flag_next
	clr_province_flag = THE_IQU_loong_vein_get_wuxing_huo_flag_next
	clr_province_flag = THE_IQU_loong_vein_get_wuxing_tu_flag_next
}
#转移省份标签
THE_IQU_move_wuxing_loong_province_flag_effect = {
	THE_IQU_move_wuxing_loong_province_flag_script = { wuxing = jin }
	THE_IQU_move_wuxing_loong_province_flag_script = { wuxing = shui }
	THE_IQU_move_wuxing_loong_province_flag_script = { wuxing = mu }
	THE_IQU_move_wuxing_loong_province_flag_script = { wuxing = huo }
	THE_IQU_move_wuxing_loong_province_flag_script = { wuxing = tu }
}
THE_IQU_move_wuxing_loong_province_flag_script = {
	if = {
		limit = { 
			any_neighbor_province = {
				has_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag
			}
		}
		random_neighbor_province = {
			limit = {
				has_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag
			}
			clr_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag
		}
		ROOT = {
			set_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag
		}
	}
	else = {
		sea_zone = {
			random_neighbor_province = {
				limit = {
					has_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag
				}
				clr_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag
			}	
			ROOT = {
				set_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag
			}
		}
	}
	if = {
		limit = { 
			any_neighbor_province = {
				has_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag_next
			}
		}
		random_neighbor_province = {
			limit = {
				has_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag_next
			}
			clr_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag_next
		}
		ROOT = {
			set_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag_next
		}
	}
	else = {
		sea_zone = {
			random_neighbor_province = {
				limit = {
					has_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag_next
				}
				clr_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag_next
			}
			ROOT = {
				set_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag_next
			}	
		}
	}
}
##天子规训 effect
##顺从度：0-100% the_iqu_the_tenshi_obedience_im_var
##教学经验：int the_iqu_the_tenshi_teaching_experience_im_var

##当前胜利点
#the_iqu_the_iqu_win_point_total_im_var
#the_iqu_the_hvr_win_point_total_im_var
THE_IQU_random_chess_playing_desc_random_flag_effect = {
	clr_country_flag = THE_IQU_random_chess_desc_flag_1
	clr_country_flag = THE_IQU_random_chess_desc_flag_2
	clr_country_flag = THE_IQU_random_chess_desc_flag_3
	clr_country_flag = THE_IQU_random_chess_desc_flag_4
	clr_country_flag = THE_IQU_random_chess_desc_flag_5
	##随机文本flag
	random_list = {
		1 = { set_country_flag = THE_IQU_random_chess_desc_flag_1 }
		1 = { set_country_flag = THE_IQU_random_chess_desc_flag_2 }
		1 = { set_country_flag = THE_IQU_random_chess_desc_flag_3 }
		1 = { set_country_flag = THE_IQU_random_chess_desc_flag_4 }
		1 = { set_country_flag = THE_IQU_random_chess_desc_flag_5 }
	}
}
##提前随机预设
THE_IQU_random_chess_playing_option_random_flag_effect_before = {
	random_list = {
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 25 hvr_win = 10 opt = 1 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 15 hvr_win = 15 opt = 1 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 15 hvr_win = 20 opt = 1 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 15 hvr_win = 10 opt = 1 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 0 hvr_win = 10 opt = 1 }
		}
	}
	random_list = {
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 15 hvr_win = 10 opt = 2 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 15 hvr_win = 15 opt = 2 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 5 hvr_win = 10 opt = 2 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 10 hvr_win = 5 opt = 2 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 0 hvr_win = 25 opt = 2 }
		}
	}
	random_list = {
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 20 hvr_win = 15 opt = 3 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 5 hvr_win = 10 opt = 3 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 10 hvr_win = 15 opt = 3 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 5 hvr_win = 0 opt = 3 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 10 hvr_win = 5 opt = 3 }
		}
	}
	random_list = {
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 5 hvr_win = 15 opt = 4 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 0 hvr_win = 5 opt = 4 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 10 hvr_win = 15 opt = 4 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 20 hvr_win = 10 opt = 4 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 0 hvr_win = 10 opt = 4 }
		}
	}
	random_list = {
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 15 hvr_win = 10 opt = 5 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 10 hvr_win = 5 opt = 5 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 5 hvr_win = 5 opt = 5 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 10 hvr_win = 10 opt = 5 }
		}
		10 = {
			THE_IQU_random_chess_playing_option_random_flag_script_before = { iqu_win = 5 hvr_win = 10 opt = 5 }
		}
	}
}
THE_IQU_random_chess_playing_option_random_flag_script_before = {
	if = {
		limit = {
			tag = IQU
		}
		set_variable = {
			which = the_iqu_iqu_chess_will_add_victory_point_$opt$
			value = $iqu_win$
		}
		set_variable = {
			which = the_iqu_hvr_chess_will_add_victory_point_$opt$
			value = $hvr_win$
		}
	}
	else = {
		IQU = {
			set_variable = {
				which = the_iqu_iqu_chess_will_add_victory_point_$opt$
				value = $iqu_win$
			}
			set_variable = {
				which = the_iqu_hvr_chess_will_add_victory_point_$opt$
				value = $hvr_win$
			}
		}
	}
}
#设定结算点数
THE_IQU_random_option_change_win_point_option_effect = {
	#增益
	if = { limit = {  check_variable = { which = the_iqu_iqu_chess_will_add_victory_point_$opt$ value = 25 } } custom_tooltip = THE_IQU_win_point_get_c_tt1 }
	else_if = { limit = {  check_variable = { which = the_iqu_iqu_chess_will_add_victory_point_$opt$ value = 20 } } custom_tooltip = THE_IQU_win_point_get_c_tt2 }
	else_if = { limit = {  check_variable = { which = the_iqu_iqu_chess_will_add_victory_point_$opt$ value = 15 } } custom_tooltip = THE_IQU_win_point_get_c_tt3 }
	else_if = { limit = {  check_variable = { which = the_iqu_iqu_chess_will_add_victory_point_$opt$ value = 10 } } custom_tooltip = THE_IQU_win_point_get_c_tt4 }
	else_if = { limit = {  check_variable = { which = the_iqu_iqu_chess_will_add_victory_point_$opt$ value = 5 } } custom_tooltip = THE_IQU_win_point_get_c_tt5 }
	else_if = { limit = {  check_variable = { which = the_iqu_iqu_chess_will_add_victory_point_$opt$ value = 0 } } custom_tooltip = THE_IQU_win_point_get_c_tt6 }
	#
	if = { limit = {  check_variable = { which = the_iqu_hvr_chess_will_add_victory_point_$opt$ value = 25 } } custom_tooltip = THE_IQU_win_point_get_c_tt7 }
	else_if = { limit = {  check_variable = { which = the_iqu_hvr_chess_will_add_victory_point_$opt$ value = 20 } } custom_tooltip = THE_IQU_win_point_get_c_tt8 }
	else_if = { limit = {  check_variable = { which = the_iqu_hvr_chess_will_add_victory_point_$opt$ value = 15 } } custom_tooltip = THE_IQU_win_point_get_c_tt9 }
	else_if = { limit = {  check_variable = { which = the_iqu_hvr_chess_will_add_victory_point_$opt$ value = 10 } } custom_tooltip = THE_IQU_win_point_get_c_tt10 }
	else_if = { limit = {  check_variable = { which = the_iqu_hvr_chess_will_add_victory_point_$opt$ value = 5 } } custom_tooltip = THE_IQU_win_point_get_c_tt11 }
	else_if = { limit = {  check_variable = { which = the_iqu_hvr_chess_will_add_victory_point_$opt$ value = 0 } } custom_tooltip = THE_IQU_win_point_get_c_tt12 }
	
	if = {
		limit = { 
			check_variable = {
				which = the_iqu_the_iqu_win_point_total_im_var
				which = the_iqu_the_hvr_win_point_total_im_var
			}
		}
		custom_tooltip = THE_IQU_win_point_get_c_tt13
	}
	else = {
		custom_tooltip = THE_IQU_win_point_get_c_tt14
	}
	hidden_effect = {
		change_variable = {
			which = the_iqu_the_iqu_win_point_total_im_var
			which = the_iqu_iqu_chess_will_add_victory_point_$opt$
		}
		change_variable = {
			which = the_iqu_the_hvr_win_point_total_im_var
			which = the_iqu_hvr_chess_will_add_victory_point_$opt$
		}
	}
}
##下棋结算胜利
THE_IQU_play_chess_end_add_point_effects = {
	change_variable = {
		which = the_iqu_the_tenshi_obedience_im_var
		value = $obedience$
	}
	hidden_effect = {
		#相减
		subtract_variable = {
			which = the_iqu_the_iqu_win_point_total_im_var
			which = the_iqu_the_hvr_win_point_total_im_var
		}
		#mission var
		change_variable = {
			which = the_iqu_mission_about_win_chess_im_var
			value = 1
		}
	}
	change_variable = {
		which = the_iqu_the_tenshi_teaching_experience_im_var
		which = the_iqu_the_iqu_win_point_total_im_var
	}
	THE_IQU_teaching_tenshi_add_power_effect = yes
}
THE_IQU_teaching_tenshi_add_power_effect = {
	if = {
		limit = {
			check_variable = {
				which = the_iqu_the_tenshi_teaching_experience_im_var
				value = 100
			}
		}
		THE_IQU_teaching_tenshi_add_power_script = yes
	}
}
# THE_IQU_teaching_tenshi_add_power_script = {
# 	if = {
# 		limit = { 
# 			HVR = { adm = 6 }
# 			HVR = { dip = 6 }
# 			HVR = { mil = 6 }
# 		}
# 		random_list = {
# 			10 = {
# 				add_adm_power = 75
# 			}
# 			10 = {
# 				add_dip_power = 75
# 			}
# 			10 = {
# 				add_mil_power = 75
# 			}
# 		}
# 		HVR = {
# 			random_list = {
# 				10 = {
# 					add_adm_power = 75
# 				}
# 				10 = {
# 					add_dip_power = 75
# 				}
# 				10 = {
# 					add_mil_power = 75
# 				}
# 			}
# 		}
# 	}
# 	#2个
# 	else_if = {
# 		limit = { 
# 			HVR = { adm = 6 }
# 			HVR = { mil = 6 }
# 		}
# 		HVR = {
# 			change_dip = 1
# 			THE_IQU_add_government_power_lvl_3_effect = { value = 1 power = dip }
# 		}
# 	}
# 	else_if = {
# 		limit = { 
# 			HVR = { dip = 6 }
# 			HVR = { mil = 6 }
# 		}
# 		HVR = {
# 			change_adm = 1
# 			THE_IQU_add_government_power_lvl_3_effect = { value = 1 power = adm }
# 		}
# 	}
# 	#一个
# 	else_if = {
# 		limit = {
# 			HVR = { mil = 6 }
# 		}
# 		HVR = {
# 			random_list = {
# 				10 = { change_adm = 1 THE_IQU_add_government_power_lvl_3_effect = { value = 1 power = adm } }
# 				10 = { change_dip = 1 THE_IQU_add_government_power_lvl_3_effect = { value = 1 power = dip } }
# 			}
# 		}
# 	}
# }
##添加政府点数
THE_IQU_government_lvl3_cloud_with_sky_add_pwoer_effect_before = {
	if = { limit = { HVR = { adm = 6 } } THE_IQU_add_government_power_lvl_3_effect = { value = 6 power = adm } }
	else_if = { limit = { HVR = { adm = 5 } } THE_IQU_add_government_power_lvl_3_effect = { value = 5 power = adm } }
	else_if = { limit = { HVR = { adm = 4 } } THE_IQU_add_government_power_lvl_3_effect = { value = 4 power = adm } }
	else_if = { limit = { HVR = { adm = 3 } } THE_IQU_add_government_power_lvl_3_effect = { value = 3 power = adm } }
	#
	if = { limit = { HVR = { dip = 6 } } THE_IQU_add_government_power_lvl_3_effect = { value = 6 power = dip } }
	else_if = { limit = { HVR = { dip = 5 } } THE_IQU_add_government_power_lvl_3_effect = { value = 5 power = dip } }
	else_if = { limit = { HVR = { dip = 4 } } THE_IQU_add_government_power_lvl_3_effect = { value = 4 power = dip } }
	else_if = { limit = { HVR = { dip = 3 } } THE_IQU_add_government_power_lvl_3_effect = { value = 3 power = dip } }
	#
	if = { limit = { HVR = { mil = 6 } } THE_IQU_add_government_power_lvl_3_effect = { value = 6 power = mil } }
}

THE_IQU_add_government_power_lvl_3_effect = {
	add_government_power = {
		mechanic_type = THE_IQU_cloud_with_sky_mechanic
		power_type = THE_IQU_with_hvr_$power$_power_power
		value = $value$
	}
}
#龙脉消止
THE_IQU_end_the_loong_vein_effect = {
	if = {
		limit = { 
			THE_IQU_num_of_wuxing_flag_province_with_trigger = {
				value = 5
			}
		}
		THE_IQU_add_unique_point_temporary_province_effects = {
			level = 5
		}
	}
	else_if = {
		limit = {
			THE_IQU_num_of_wuxing_flag_province_with_trigger = {
				value = 4
			}
		}
		THE_IQU_add_unique_point_temporary_province_effects = {
			level = 4
		}
	}
	else_if = {
		limit = {
			THE_IQU_num_of_wuxing_flag_province_with_trigger = {
				value = 3
			}
		}
		THE_IQU_add_unique_point_temporary_province_effects = {
			level = 3
		}
	}
	else_if = {
		limit = {
			THE_IQU_num_of_wuxing_flag_province_with_trigger = {
				value = 2
			}
		}
		THE_IQU_add_unique_point_temporary_province_effects = {
			level = 2
		}
	}
	else_if = {
		limit = {
			THE_IQU_num_of_wuxing_flag_province_with_trigger = {
				value = 1
			}
		}
		THE_IQU_add_unique_point_temporary_province_effects = {
			level = 1
		}
	}
	####获得特殊点五行
	# THE_IQU_has_get_unique_point_is_jin_flag
	# THE_IQU_has_get_unique_point_is_shui_flag
	# THE_IQU_has_get_unique_point_is_mu_flag
	# THE_IQU_has_get_unique_point_is_huo_flag
	# THE_IQU_has_get_unique_point_is_tu_flag
	hidden_effect = {
		if = {
			limit = { 
				THE_IQU_has_any_province_wuxing_flag_trigger = {
					wuxing = jin
				}
			}
			set_country_flag = THE_IQU_has_get_unique_point_is_jin_flag
		}
		if = {
			limit = { 
				THE_IQU_has_any_province_wuxing_flag_trigger = {
					wuxing = shui
				}
			}
			set_country_flag = THE_IQU_has_get_unique_point_is_shui_flag
		}
		if = {
			limit = { 
				THE_IQU_has_any_province_wuxing_flag_trigger = {
					wuxing = mu
				}
			}
			set_country_flag = THE_IQU_has_get_unique_point_is_mu_flag
		}
		if = {
			limit = { 
				THE_IQU_has_any_province_wuxing_flag_trigger = {
					wuxing = huo
				}
			}
			set_country_flag = THE_IQU_has_get_unique_point_is_huo_flag
		}
		if = {
			limit = { 
				THE_IQU_has_any_province_wuxing_flag_trigger = {
					wuxing = tu
				}
			}
			set_country_flag = THE_IQU_has_get_unique_point_is_tu_flag
		}
		clr_country_flag = THE_IQU_loong_vein_get_wuxing_jin_flag
		clr_country_flag = THE_IQU_loong_vein_get_wuxing_shui_flag
		clr_country_flag = THE_IQU_loong_vein_get_wuxing_mu_flag
		clr_country_flag = THE_IQU_loong_vein_get_wuxing_huo_flag
		clr_country_flag = THE_IQU_loong_vein_get_wuxing_tu_flag
		#
		clr_country_flag = THE_IQU_loong_vein_get_wuxing_jin_flag_next
		clr_country_flag = THE_IQU_loong_vein_get_wuxing_shui_flag_next
		clr_country_flag = THE_IQU_loong_vein_get_wuxing_mu_flag_next
		clr_country_flag = THE_IQU_loong_vein_get_wuxing_huo_flag_next
		clr_country_flag = THE_IQU_loong_vein_get_wuxing_tu_flag_next
		#
		remove_province_modifier = THE_IQU_lonng_vein_head_province_buff
	}
}

#
THE_IQU_add_diplomacal_experience_var_effect = {
	custom_tooltip = THE_IQU_add_experience_var_c_tt1
	hidden_effect = {
		change_variable = {
			which = the_iqu_diplomacal_experience_change_im_var
			value = 1
		}
	}
}
THE_IQU_add_learning_experience_var_effect = {
	custom_tooltip = THE_IQU_add_experience_var_c_tt2
	hidden_effect = {
		change_variable = {
			which = the_iqu_learning_experience_change_im_var
			value = 1
		}
	}
}
THE_IQU_add_nautical_experience_var_effect = {
	custom_tooltip = THE_IQU_add_experience_var_c_tt3
	hidden_effect = {
		change_variable = {
			which = the_iqu_nautical_experience_change_im_var
			value = 1
		}
	}
}

THE_IQU_will_get_wuxing_point_after_explore_effect = {
	if = {
		limit = { 
			ROOT = {
				has_government_attribute = THE_IQU_tennin_one_taoist_reform_mechanic
				OR = {
					was_tag = IQU
					tag = IQU
				}
			}
		}
		if = {
			limit = { 
				THIS = {
					THE_IQU_any_province_point_has_wuxing_flag_trigger = {
						wuxing = jin
					}
				}
			}
			custom_tooltip = THE_IQU_will_get_wuxing_point_after_explore_c_tt6
			custom_tooltip = THE_IQU_will_get_wuxing_point_after_explore_c_tt1
		}
		if = {
			limit = { 
				THIS = {
					THE_IQU_any_province_point_has_wuxing_flag_trigger = {
						wuxing = shui
					}
				}
			}
			custom_tooltip = THE_IQU_will_get_wuxing_point_after_explore_c_tt6
			custom_tooltip = THE_IQU_will_get_wuxing_point_after_explore_c_tt2
		}
		if = {
			limit = { 
				THIS = {
					THE_IQU_any_province_point_has_wuxing_flag_trigger = {
						wuxing = mu
					}
				}
			}
			custom_tooltip = THE_IQU_will_get_wuxing_point_after_explore_c_tt6
			custom_tooltip = THE_IQU_will_get_wuxing_point_after_explore_c_tt3
		}
		if = {
			limit = { 
				THIS = {
					THE_IQU_any_province_point_has_wuxing_flag_trigger = {
						wuxing = huo
					}
				}
			}
			custom_tooltip = THE_IQU_will_get_wuxing_point_after_explore_c_tt6
			custom_tooltip = THE_IQU_will_get_wuxing_point_after_explore_c_tt4
		}
		if = {
			limit = { 
				THIS = {
					THE_IQU_any_province_point_has_wuxing_flag_trigger = {
						wuxing = tu
					}
				}
			}
			custom_tooltip = THE_IQU_will_get_wuxing_point_after_explore_c_tt6
			custom_tooltip = THE_IQU_will_get_wuxing_point_after_explore_c_tt5
		}
	}
}
#探险后结算
THE_IQU_after_get_wuxing_point_after_explore_effect = {
	if = {
		limit = { 
			ROOT = {
				has_government_attribute = THE_IQU_tennin_one_taoist_reform_mechanic
				OR = {
					was_tag = IQU
					tag = IQU
				}
			}
		}
		if = {
			limit = { 
				THIS = {
					THE_IQU_any_province_point_has_wuxing_flag_trigger = {
						wuxing = jin
					}
				}
			}
			custom_tooltip = THE_IQU_will_get_wuxing_point_after_explore_c_tt1
			hidden_effect = {
				random_country = {
					limit = {
						has_government_mechanic = THE_IQU_tennin_one_taoist_mechanic
					}
					add_government_power = {
						mechanic_type = THE_IQU_tennin_one_taoist_mechanic
						power_type = THE_IQU_tennin_one_taoist_jin_power
						value = 1
					}
				}
			}
		}
		if = {
			limit = { 
				THIS = {
					THE_IQU_any_province_point_has_wuxing_flag_trigger = {
						wuxing = shui
					}
				}
			}
			custom_tooltip = THE_IQU_will_get_wuxing_point_after_explore_c_tt2
			hidden_effect = {
				random_country = {
					limit = {
						has_government_mechanic = THE_IQU_tennin_one_taoist_mechanic
					}
					add_government_power = {
						mechanic_type = THE_IQU_tennin_one_taoist_mechanic
						power_type = THE_IQU_tennin_one_taoist_shui_power
						value = 1
					}
				}
			}
		}
		if = {
			limit = { 
				THIS = {
					THE_IQU_any_province_point_has_wuxing_flag_trigger = {
						wuxing = mu
					}
				}
			}
			custom_tooltip = THE_IQU_will_get_wuxing_point_after_explore_c_tt3
			hidden_effect = {
				random_country = {
					limit = {
						has_government_mechanic = THE_IQU_tennin_one_taoist_mechanic
					}
					add_government_power = {
						mechanic_type = THE_IQU_tennin_one_taoist_mechanic
						power_type = THE_IQU_tennin_one_taoist_mu_power
						value = 1
					}
				}
			}
		}
		if = {
			limit = { 
				THIS = {
					THE_IQU_any_province_point_has_wuxing_flag_trigger = {
						wuxing = huo
					}
				}
			}
			custom_tooltip = THE_IQU_will_get_wuxing_point_after_explore_c_tt4
			hidden_effect = {
				random_country = {
					limit = {
						has_government_mechanic = THE_IQU_tennin_one_taoist_mechanic
					}
					add_government_power = {
						mechanic_type = THE_IQU_tennin_one_taoist_mechanic
						power_type = THE_IQU_tennin_one_taoist_huo_power
						value = 1
					}
				}
			}
		}
		if = {
			limit = { 
				THIS = {
					THE_IQU_any_province_point_has_wuxing_flag_trigger = {
						wuxing = tu
					}
				}
			}
			custom_tooltip = THE_IQU_will_get_wuxing_point_after_explore_c_tt5
			hidden_effect = {
				random_country = {
					limit = {
						has_government_mechanic = THE_IQU_tennin_one_taoist_mechanic
					}
					add_government_power = {
						mechanic_type = THE_IQU_tennin_one_taoist_mechanic
						power_type = THE_IQU_tennin_one_taoist_tu_power
						value = 1
					}
				}
			}
		}
	}
}
################################
##On Action Script
##############################
THE_IQU_on_startup_scripted_effects = {
	if = {
		limit = {
			tag = IQU
			NOT = { has_country_flag = THE_IQU_on_startup_set_variable_flag }
		}
		set_variable = { which = the_iqu_nautical_experience_change_im_var value = 0 }
		set_variable = { which = the_iqu_learning_experience_change_im_var value = 0 }
		set_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 0 }
		#MISSION 
		set_variable = { which = the_iqu_explore_province_number_im_var value = 0 }
		set_variable = { which = the_iqu_mission_about_win_chess_im_var value = 0 }
		set_variable = { which = the_iqu_the_tenshi_obedience_im_var value = 0 }
		set_variable = { which = the_iqu_the_tenshi_teaching_experience_im_var value = 0 }
		set_variable = { which = the_iqu_had_explore_area_number_im_var value = 0 }
		set_variable = { which = the_iqu_jungle_province_has_been_teer_im_var value = 0 }
		set_variable = { which = the_iqu_mountain_province_has_been_teer_im_var value = 0 }
		##START EVENT
		
		country_event = {
			id = THE_IQU_flavor_events.238
			# days = 3
		}
		HVR = {
			country_event = {
				id = THE_IQU_flavor_events.237
			}
		}
		set_country_flag = THE_IQU_on_startup_set_variable_flag
		set_country_flag = no_colonial_nations
	}
}
#殖民完成oa
THE_IQU_scarlet_sky_government_effects = {
	if = {
		limit = { 
			owner = {
				has_government_attribute = THE_IQU_scarlet_sky_reform_mechanic
			}
			NOT = {
				has_province_flag = THE_IQU_area_has_lock_the_loong_vein_flag
			}
		}
		owner = {
			country_event = {
				id = THE_IQU_flavor_events.1003
				days = 2
			}
		}
	}
	if = {
		limit = { 
			owner = {
				mission_completed = THE_IQU_2_7
			}
		}
		add_base_production = 1
	}
	if = {
		limit = { 
			owner = {
				mission_completed = THE_IQU_5_4
			}
		}
		add_base_production = 1
	}
	if = {
		limit = { 
			owner = {
				mission_completed = THE_IQU_1_8
			}
			region = carribeans_region
		}
		random_list = {
			75 = {
				change_trade_goods = coffee
			}
			25 = {
				
			}
		}
	}
}
#建立殖民地oa
THE_IQU_number_explore_province_im_var_effect = {
	#建立殖民地
	if = {
		limit = {
			owner = {
				mission_completed = THE_IQU_1_7
			}
		}
		owner = {
			add_army_tradition = 1
		}
	}
}

#探索事件
THE_IQU_panama_add_unique_point_event_effect = {
	#巴拿马
	if = {
		limit = { 
			owner = {
				OR = {
					tag = IQU
					was_tag = IQU
				}
			}
			NOT = { has_province_flag = THE_IQU_has_first_discover_flag	}
			province_id = 835
		}
		owner = {
			country_event = {
				id = THE_IQU_flavor_events.60
			}
		}
		set_province_flag = THE_IQU_has_first_discover_flag
	}
	#西印度
	if = {
		limit = { 
			owner = {
				OR = {
					tag = IQU
					was_tag = IQU
				}
			}
			NOT = { has_province_flag = THE_IQU_has_first_discover_flag	}
			province_id = 487
		}
		owner = {
			country_event = {
				id = THE_IQU_flavor_events.61
			}
		}
		set_province_flag = THE_IQU_has_first_discover_flag
	}
	#亚马孙
	if = {
		limit = { 
			owner = {
				OR = {
					tag = IQU
					was_tag = IQU
				}
			}
			NOT = { has_province_flag = THE_IQU_has_first_discover_flag	}
			province_id = 2890
		}
		owner = {
			country_event = {
				id = THE_IQU_flavor_events.62
			}
		}
		set_province_flag = THE_IQU_has_first_discover_flag
	}
	#北美东海岸
	if = {
		limit = { 
			owner = {
				OR = {
					tag = IQU
					was_tag = IQU
				}
			}
			NOT = { has_province_flag = THE_IQU_has_first_discover_flag	}
			province_id = 938
		}
		owner = {
			country_event = {
				id = THE_IQU_flavor_events.63
			}
		}
		set_province_flag = THE_IQU_has_first_discover_flag
	}
	#澳大利亚
	if = {
		limit = { 
			owner = {
				OR = {
					tag = IQU
					was_tag = IQU
				}
			}
			NOT = { has_province_flag = THE_IQU_has_first_discover_flag	}
			province_id = 4850
		}
		owner = {
			country_event = {
				id = THE_IQU_flavor_events.64
			}
		}
		set_province_flag = THE_IQU_has_first_discover_flag
	}
	#加拿大
	if = {
		limit = { 
			owner = {
				OR = {
					tag = IQU
					was_tag = IQU
				}
			}
			NOT = { has_province_flag = THE_IQU_has_first_discover_flag	}
			province_id = 980
		}
		owner = {
			country_event = {
				id = THE_IQU_flavor_events.65
			}
		}
		set_province_flag = THE_IQU_has_first_discover_flag
	}
	#密西西比
	if = {
		limit = { 
			owner = {
				OR = {
					tag = IQU
					was_tag = IQU
				}
			}
			NOT = { has_province_flag = THE_IQU_has_first_discover_flag	}
			province_id = 893
		}
		owner = {
			country_event = {
				id = THE_IQU_flavor_events.1004
			}
		}
		set_province_flag = THE_IQU_has_first_discover_flag
	}
	#拉普拉塔
	if = {
		limit = { 
			owner = {
				OR = {
					tag = IQU
					was_tag = IQU
				}
			}
			NOT = { has_province_flag = THE_IQU_has_first_discover_flag	}
			province_id = 778
		}
		owner = {
			country_event = {
				id = THE_IQU_flavor_events.1004
			}
		}
		set_province_flag = THE_IQU_has_first_discover_flag
	}
	
	#异常点
	if = {
		limit = { 
			owner = {
				OR = {
					tag = IQU
					was_tag = IQU
				}
				mission_completed = THE_IQU_1_5
			}
			ROOT = {
				#THE_IQU_this_province_had_been_explored_flag 已经完成探索
				#THE_IQU_province_unique_point_flag 异常点探索
				has_port = yes
				NOT = {
					has_province_flag = THE_IQU_province_unique_point_flag
				}
				NOT = {
					has_province_flag = THE_IQU_this_province_had_been_explored_flag
				}
				NOT = {
					continent = gensokyo_continent
				}
				NOT = {
					continent = moon_continent
				}
				NOT = { province_id = 835 }
				NOT = { province_id = 487 }
				NOT = { province_id = 2890 }
				NOT = { province_id = 938 }
				NOT = { province_id = 4850 }
				NOT = { province_id = 980 }
				NOT = { province_id = 893 }
				NOT = { province_id = 778 }
			}
			
		}
		random_list = {
			10 = {
				owner = {
					country_event = {
						id = THE_IQU_flavor_events.1004
					}
				}
			}
			90 = { }
		}
	}
	
	
	# #巴拿马
	# if = {
	# 	limit = { 
	# 		owner = {
	# 			OR = {
	# 				is_subject_of = IQU
	# 			}
	# 		}
	# 		NOT = { has_province_flag = THE_IQU_has_first_discover_flag	}
	# 		province_id = 835
	# 	}
	# 	owner = {
	# 		colonial_parent = {
	# 			country_event = {
	# 				id = THE_IQU_flavor_events.60
	# 			}
	# 		}
	# 	}
	# 	set_province_flag = THE_IQU_has_first_discover_flag
	# }
	# #西印度
	# if = {
	# 	limit = { 
	# 		owner = {
	# 			OR = {
	# 				is_subject_of = IQU
	# 			}
	# 		}
	# 		NOT = { has_province_flag = THE_IQU_has_first_discover_flag	}
	# 		province_id = 487
	# 	}
	# 	owner = {
	# 		colonial_parent = {
	# 			country_event = {
	# 				id = THE_IQU_flavor_events.61
	# 			}
	# 		}
	# 	}
	# 	set_province_flag = THE_IQU_has_first_discover_flag
	# }
	# #亚马孙
	# if = {
	# 	limit = { 
	# 		owner = {
	# 			OR = {
	# 				is_subject_of = IQU
	# 			}
	# 		}
	# 		NOT = { has_province_flag = THE_IQU_has_first_discover_flag	}
	# 		province_id = 2890
	# 	}
	# 	owner = {
	# 		colonial_parent = {
	# 			country_event = {
	# 				id = THE_IQU_flavor_events.62
	# 			}
	# 		}
	# 	}
	# 	set_province_flag = THE_IQU_has_first_discover_flag
	# }
	# #北美东海岸
	# if = {
	# 	limit = { 
	# 		owner = {
	# 			OR = {
	# 				is_subject_of = IQU
	# 			}
	# 		}
	# 		NOT = { has_province_flag = THE_IQU_has_first_discover_flag	}
	# 		province_id = 938
	# 	}
	# 	owner = {
	# 		colonial_parent = {
	# 			country_event = {
	# 				id = THE_IQU_flavor_events.63
	# 			}
	# 		}
	# 	}
	# 	set_province_flag = THE_IQU_has_first_discover_flag
	# }
	# #澳大利亚
	# if = {
	# 	limit = { 
	# 		owner = {
	# 			OR = {
	# 				is_subject_of = IQU
	# 			}
	# 		}
	# 		NOT = { has_province_flag = THE_IQU_has_first_discover_flag	}
	# 		province_id = 4850
	# 	}
	# 	owner = {
	# 		colonial_parent = {
	# 			country_event = {
	# 				id = THE_IQU_flavor_events.64
	# 			}
	# 		}
	# 	}
	# 	set_province_flag = THE_IQU_has_first_discover_flag
	# }
	# #加拿大
	# if = {
	# 	limit = { 
	# 		owner = {
	# 			OR = {
	# 				is_subject_of = IQU
	# 			}
	# 		}
	# 		NOT = { has_province_flag = THE_IQU_has_first_discover_flag	}
	# 		province_id = 980
	# 	}
	# 	owner = {
	# 		colonial_parent = {
	# 			country_event = {
	# 				id = THE_IQU_flavor_events.65
	# 			}
	# 		}
	# 	}
	# 	set_province_flag = THE_IQU_has_first_discover_flag
	# }
	# #密西西比
	# if = {
	# 	limit = { 
	# 		owner = {
	# 			OR = {
	# 				is_subject_of = IQU
	# 			}
	# 		}
	# 		NOT = { has_province_flag = THE_IQU_has_first_discover_flag	}
	# 		province_id = 893
	# 	}
	# 	owner = {
	# 		colonial_parent = {
	# 			country_event = {
	# 				id = THE_IQU_flavor_events.1004
	# 			}
	# 		}
	# 	}
	# 	set_province_flag = THE_IQU_has_first_discover_flag
	# }
	# #拉普拉塔
	# if = {
	# 	limit = { 
	# 		owner = {
	# 			OR = {
	# 				is_subject_of = IQU
	# 			}
	# 		}
	# 		NOT = { has_province_flag = THE_IQU_has_first_discover_flag	}
	# 		province_id = 778
	# 	}
	# 	owner = {
	# 		colonial_parent = {
	# 			country_event = {
	# 				id = THE_IQU_flavor_events.1004
	# 			}
	# 		}
	# 	}
	# 	set_province_flag = THE_IQU_has_first_discover_flag
	# }
	
	
}

###2年脉冲
THE_IQU_explore_on_2_years_pluse_effect = {
	if = {
		limit = { 
			OR = {
				tag = IQU
				was_tag = IQU
			}
			has_country_flag = THE_IQU_now_is_exploring_flag
		}
		if = {
			limit = {
				any_owned_province = {
					region = cascadia_region
					has_province_flag = THE_IQU_this_provinces_is_exploring_now
				}
			}
			random_list = {
				10 = { country_event = { id = THE_IQU_flavor_events.66 } }
				10 = { country_event = { id = THE_IQU_flavor_events.70 } }
				10 = { country_event = { id = THE_IQU_flavor_events.75 } }
				10 = { country_event = { id = THE_IQU_flavor_events.79 } }
				10 = { country_event = { id = THE_IQU_flavor_events.83 } }
				10 = { country_event = { id = THE_IQU_flavor_events.86 } }
				10 = { country_event = { id = THE_IQU_flavor_events.90 } }
				10 = { country_event = { id = THE_IQU_flavor_events.95 } }
				10 = { country_event = { id = THE_IQU_flavor_events.99 } }
				10 = { country_event = { id = THE_IQU_flavor_events.102 } }
				10 = { country_event = { id = THE_IQU_flavor_events.107 } }
				10 = { country_event = { id = THE_IQU_flavor_events.110 } }
				10 = { country_event = { id = THE_IQU_flavor_events.114 } }
				10 = { country_event = { id = THE_IQU_flavor_events.117 } }
				10 = { country_event = { id = THE_IQU_flavor_events.121 } }
				10 = { country_event = { id = THE_IQU_flavor_events.126 } }
				#
				20 = { country_event = { id = THE_IQU_flavor_events.130 } }
				20 = { country_event = { id = THE_IQU_flavor_events.133 } }
				20 = { country_event = { id = THE_IQU_flavor_events.137 } }
				20 = { country_event = { id = THE_IQU_flavor_events.141 } }
				20 = { country_event = { id = THE_IQU_flavor_events.236 } }
			}
		}
		if = {
			limit = { 
				any_owned_province = {
					has_province_flag = THE_IQU_this_provinces_is_exploring_now
					OR = {
						region = peru_region
						region = upper_peru_region
						region = la_plata_region
					}
				}
			}
			random_list = {
				10 = { country_event = { id = THE_IQU_flavor_events.66 } }
				10 = { country_event = { id = THE_IQU_flavor_events.70 } }
				10 = { country_event = { id = THE_IQU_flavor_events.75 } }
				10 = { country_event = { id = THE_IQU_flavor_events.79 } }
				10 = { country_event = { id = THE_IQU_flavor_events.83 } }
				10 = { country_event = { id = THE_IQU_flavor_events.86 } }
				10 = { country_event = { id = THE_IQU_flavor_events.90 } }
				10 = { country_event = { id = THE_IQU_flavor_events.95 } }
				10 = { country_event = { id = THE_IQU_flavor_events.99 } }
				10 = { country_event = { id = THE_IQU_flavor_events.102 } }
				10 = { country_event = { id = THE_IQU_flavor_events.107 } }
				10 = { country_event = { id = THE_IQU_flavor_events.110 } }
				10 = { country_event = { id = THE_IQU_flavor_events.114 } }
				10 = { country_event = { id = THE_IQU_flavor_events.117 } }
				10 = { country_event = { id = THE_IQU_flavor_events.121 } }
				10 = { country_event = { id = THE_IQU_flavor_events.126 } }
				#
				20 = { country_event = { id = THE_IQU_flavor_events.144 } }
				20 = { country_event = { id = THE_IQU_flavor_events.148 } }
				20 = { country_event = { id = THE_IQU_flavor_events.153 } }
				20 = { country_event = { id = THE_IQU_flavor_events.156 } }
				20 = { country_event = { id = THE_IQU_flavor_events.236 } }
			}
		}
		if = {
			limit = { 
				any_owned_province = {
					has_province_flag = THE_IQU_this_provinces_is_exploring_now
					OR = {
						region = caribbean_sea_region
						region = southeast_america_region
						region = mississippi_region
					}
				}
			}
			random_list = {
				10 = { country_event = { id = THE_IQU_flavor_events.66 } }
				10 = { country_event = { id = THE_IQU_flavor_events.70 } }
				10 = { country_event = { id = THE_IQU_flavor_events.75 } }
				10 = { country_event = { id = THE_IQU_flavor_events.79 } }
				10 = { country_event = { id = THE_IQU_flavor_events.83 } }
				10 = { country_event = { id = THE_IQU_flavor_events.86 } }
				10 = { country_event = { id = THE_IQU_flavor_events.90 } }
				10 = { country_event = { id = THE_IQU_flavor_events.95 } }
				10 = { country_event = { id = THE_IQU_flavor_events.99 } }
				10 = { country_event = { id = THE_IQU_flavor_events.102 } }
				10 = { country_event = { id = THE_IQU_flavor_events.107 } }
				10 = { country_event = { id = THE_IQU_flavor_events.110 } }
				10 = { country_event = { id = THE_IQU_flavor_events.114 } }
				10 = { country_event = { id = THE_IQU_flavor_events.117 } }
				10 = { country_event = { id = THE_IQU_flavor_events.121 } }
				10 = { country_event = { id = THE_IQU_flavor_events.126 } }
				#
				20 = { country_event = { id = THE_IQU_flavor_events.176 } }
				20 = { country_event = { id = THE_IQU_flavor_events.179 } }
				20 = { country_event = { id = THE_IQU_flavor_events.184 } }
				20 = { country_event = { id = THE_IQU_flavor_events.187 } }
				20 = { country_event = { id = THE_IQU_flavor_events.236 } }
			}
			#  random_events = {
			# 	10 = THE_IQU_flavor_events.66
			# 	10 = THE_IQU_flavor_events.70
			# 	10 = THE_IQU_flavor_events.75
			# 	10 = THE_IQU_flavor_events.79
			# 	10 = THE_IQU_flavor_events.83
			# 	10 = THE_IQU_flavor_events.86
			# 	10 = THE_IQU_flavor_events.90
			# 	10 = THE_IQU_flavor_events.95
			# 	10 = THE_IQU_flavor_events.99
			# 	10 = THE_IQU_flavor_events.102
			# 	10 = THE_IQU_flavor_events.107
			# 	10 = THE_IQU_flavor_events.110
			# 	10 = THE_IQU_flavor_events.114
			# 	10 = THE_IQU_flavor_events.117
			# 	10 = THE_IQU_flavor_events.121
			# 	10 = THE_IQU_flavor_events.126
			# 	##
			# 	20 = THE_IQU_flavor_events.176
			# 	20 = THE_IQU_flavor_events.179
			# 	20 = THE_IQU_flavor_events.184
			# 	20 = THE_IQU_flavor_events.187
			# 	#
			# 	5 = THE_IQU_flavor_events.236
			# }
			
		}
		if = {
			limit = { 
				any_owned_province = {
					has_province_flag = THE_IQU_this_provinces_is_exploring_now
					OR = {
						region = canada_region
						region = northeast_america_region
						region = great_lakes_region
					}
				}
			}
			random_list = {
				10 = { country_event = { id = THE_IQU_flavor_events.66 } }
				10 = { country_event = { id = THE_IQU_flavor_events.70 } }
				10 = { country_event = { id = THE_IQU_flavor_events.75 } }
				10 = { country_event = { id = THE_IQU_flavor_events.79 } }
				10 = { country_event = { id = THE_IQU_flavor_events.83 } }
				10 = { country_event = { id = THE_IQU_flavor_events.86 } }
				10 = { country_event = { id = THE_IQU_flavor_events.90 } }
				10 = { country_event = { id = THE_IQU_flavor_events.95 } }
				10 = { country_event = { id = THE_IQU_flavor_events.99 } }
				10 = { country_event = { id = THE_IQU_flavor_events.102 } }
				10 = { country_event = { id = THE_IQU_flavor_events.107 } }
				10 = { country_event = { id = THE_IQU_flavor_events.110 } }
				10 = { country_event = { id = THE_IQU_flavor_events.114 } }
				10 = { country_event = { id = THE_IQU_flavor_events.117 } }
				10 = { country_event = { id = THE_IQU_flavor_events.121 } }
				10 = { country_event = { id = THE_IQU_flavor_events.126 } }
				#
				20 = { country_event = { id = THE_IQU_flavor_events.192 } }
				20 = { country_event = { id = THE_IQU_flavor_events.195 } }
				20 = { country_event = { id = THE_IQU_flavor_events.199 } }
				20 = { country_event = { id = THE_IQU_flavor_events.202 } }
				20 = { country_event = { id = THE_IQU_flavor_events.236 } }
			}
			#  random_events = {
			# 	10 = THE_IQU_flavor_events.66
			# 	10 = THE_IQU_flavor_events.70
			# 	10 = THE_IQU_flavor_events.75
			# 	10 = THE_IQU_flavor_events.79
			# 	10 = THE_IQU_flavor_events.83
			# 	10 = THE_IQU_flavor_events.86
			# 	10 = THE_IQU_flavor_events.90
			# 	10 = THE_IQU_flavor_events.95
			# 	10 = THE_IQU_flavor_events.99
			# 	10 = THE_IQU_flavor_events.102
			# 	10 = THE_IQU_flavor_events.107
			# 	10 = THE_IQU_flavor_events.110
			# 	10 = THE_IQU_flavor_events.114
			# 	10 = THE_IQU_flavor_events.117
			# 	10 = THE_IQU_flavor_events.121
			# 	10 = THE_IQU_flavor_events.126
			# 	##
			# 	20 = THE_IQU_flavor_events.192
			# 	20 = THE_IQU_flavor_events.195
			# 	20 = THE_IQU_flavor_events.199
			# 	20 = THE_IQU_flavor_events.202
			# 	#
			# 	5 = THE_IQU_flavor_events.236
			# }
			
		}
		if = {
			limit = { 
				any_owned_province = {
					has_province_flag = THE_IQU_this_provinces_is_exploring_now
					OR = {
						region = colombia_region
						region = brazil_region
						region = central_america_region
					}
				}
			}
			random_list = {
				10 = { country_event = { id = THE_IQU_flavor_events.66 } }
				10 = { country_event = { id = THE_IQU_flavor_events.70 } }
				10 = { country_event = { id = THE_IQU_flavor_events.75 } }
				10 = { country_event = { id = THE_IQU_flavor_events.79 } }
				10 = { country_event = { id = THE_IQU_flavor_events.83 } }
				10 = { country_event = { id = THE_IQU_flavor_events.86 } }
				10 = { country_event = { id = THE_IQU_flavor_events.90 } }
				10 = { country_event = { id = THE_IQU_flavor_events.95 } }
				10 = { country_event = { id = THE_IQU_flavor_events.99 } }
				10 = { country_event = { id = THE_IQU_flavor_events.102 } }
				10 = { country_event = { id = THE_IQU_flavor_events.107 } }
				10 = { country_event = { id = THE_IQU_flavor_events.110 } }
				10 = { country_event = { id = THE_IQU_flavor_events.114 } }
				10 = { country_event = { id = THE_IQU_flavor_events.117 } }
				10 = { country_event = { id = THE_IQU_flavor_events.121 } }
				10 = { country_event = { id = THE_IQU_flavor_events.126 } }
				#
				20 = { country_event = { id = THE_IQU_flavor_events.160 } }
				20 = { country_event = { id = THE_IQU_flavor_events.163 } }
				20 = { country_event = { id = THE_IQU_flavor_events.168 } }
				20 = { country_event = { id = THE_IQU_flavor_events.173 } }
				20 = { country_event = { id = THE_IQU_flavor_events.236 } }
			}
			#  random_events = {
			# 	10 = THE_IQU_flavor_events.66
			# 	10 = THE_IQU_flavor_events.70
			# 	10 = THE_IQU_flavor_events.75
			# 	10 = THE_IQU_flavor_events.79
			# 	10 = THE_IQU_flavor_events.83
			# 	10 = THE_IQU_flavor_events.86
			# 	10 = THE_IQU_flavor_events.90
			# 	10 = THE_IQU_flavor_events.95
			# 	10 = THE_IQU_flavor_events.99
			# 	10 = THE_IQU_flavor_events.102
			# 	10 = THE_IQU_flavor_events.107
			# 	10 = THE_IQU_flavor_events.110
			# 	10 = THE_IQU_flavor_events.114
			# 	10 = THE_IQU_flavor_events.117
			# 	10 = THE_IQU_flavor_events.121
			# 	10 = THE_IQU_flavor_events.126
			# 	##
			# 	20 = THE_IQU_flavor_events.160
			# 	20 = THE_IQU_flavor_events.163
			# 	20 = THE_IQU_flavor_events.168
			# 	20 = THE_IQU_flavor_events.173
			# 	#
			# 	5 = THE_IQU_flavor_events.236
			# }
		}
		if = {
			limit = { 
				any_owned_province = {
					has_province_flag = THE_IQU_this_provinces_is_exploring_now
					OR = {
						region = australia_region
					}
				}
			}
			random_list = {
				10 = { country_event = { id = THE_IQU_flavor_events.66 } }
				10 = { country_event = { id = THE_IQU_flavor_events.70 } }
				10 = { country_event = { id = THE_IQU_flavor_events.75 } }
				10 = { country_event = { id = THE_IQU_flavor_events.79 } }
				10 = { country_event = { id = THE_IQU_flavor_events.83 } }
				10 = { country_event = { id = THE_IQU_flavor_events.86 } }
				10 = { country_event = { id = THE_IQU_flavor_events.90 } }
				10 = { country_event = { id = THE_IQU_flavor_events.95 } }
				10 = { country_event = { id = THE_IQU_flavor_events.99 } }
				10 = { country_event = { id = THE_IQU_flavor_events.102 } }
				10 = { country_event = { id = THE_IQU_flavor_events.107 } }
				10 = { country_event = { id = THE_IQU_flavor_events.110 } }
				10 = { country_event = { id = THE_IQU_flavor_events.114 } }
				10 = { country_event = { id = THE_IQU_flavor_events.117 } }
				10 = { country_event = { id = THE_IQU_flavor_events.121 } }
				10 = { country_event = { id = THE_IQU_flavor_events.126 } }
				#
				20 = { country_event = { id = THE_IQU_flavor_events.206 } }
				20 = { country_event = { id = THE_IQU_flavor_events.209 } }
				20 = { country_event = { id = THE_IQU_flavor_events.213 } }
				20 = { country_event = { id = THE_IQU_flavor_events.216 } }
				20 = { country_event = { id = THE_IQU_flavor_events.236 } }
			}
			#  random_events = {
			# 	10 = THE_IQU_flavor_events.66
			# 	10 = THE_IQU_flavor_events.70
			# 	10 = THE_IQU_flavor_events.75
			# 	10 = THE_IQU_flavor_events.79
			# 	10 = THE_IQU_flavor_events.83
			# 	10 = THE_IQU_flavor_events.86
			# 	10 = THE_IQU_flavor_events.90
			# 	10 = THE_IQU_flavor_events.95
			# 	10 = THE_IQU_flavor_events.99
			# 	10 = THE_IQU_flavor_events.102
			# 	10 = THE_IQU_flavor_events.107
			# 	10 = THE_IQU_flavor_events.110
			# 	10 = THE_IQU_flavor_events.114
			# 	10 = THE_IQU_flavor_events.117
			# 	10 = THE_IQU_flavor_events.121
			# 	10 = THE_IQU_flavor_events.126
			# 	##
			# 	20 = THE_IQU_flavor_events.206
			# 	20 = THE_IQU_flavor_events.209
			# 	20 = THE_IQU_flavor_events.213
			# 	20 = THE_IQU_flavor_events.216
			# 	#
			# 	5 = THE_IQU_flavor_events.236
			# }
		}
		if = {
			limit = { 
				any_owned_province = {
					has_province_flag = THE_IQU_this_provinces_is_exploring_now
					OR = {
						region = british_isles_region
					}
				}
			}
			random_list = {
				10 = { country_event = { id = THE_IQU_flavor_events.66 } }
				10 = { country_event = { id = THE_IQU_flavor_events.70 } }
				10 = { country_event = { id = THE_IQU_flavor_events.75 } }
				10 = { country_event = { id = THE_IQU_flavor_events.79 } }
				10 = { country_event = { id = THE_IQU_flavor_events.83 } }
				10 = { country_event = { id = THE_IQU_flavor_events.86 } }
				10 = { country_event = { id = THE_IQU_flavor_events.90 } }
				10 = { country_event = { id = THE_IQU_flavor_events.95 } }
				10 = { country_event = { id = THE_IQU_flavor_events.99 } }
				# 10 = { country_event = { id = THE_IQU_flavor_events.102 } }
				# 10 = { country_event = { id = THE_IQU_flavor_events.107 } }
				# 10 = { country_event = { id = THE_IQU_flavor_events.110 } }
				# 10 = { country_event = { id = THE_IQU_flavor_events.114 } }
				# 10 = { country_event = { id = THE_IQU_flavor_events.117 } }
				10 = { country_event = { id = THE_IQU_flavor_events.121 } }
				# 10 = { country_event = { id = THE_IQU_flavor_events.126 } }
				#
				20 = { country_event = { id = THE_IQU_flavor_events.220 } }
				20 = { country_event = { id = THE_IQU_flavor_events.224 } }
				20 = { country_event = { id = THE_IQU_flavor_events.228 } }
				20 = { country_event = { id = THE_IQU_flavor_events.233 } }
				
				20 = { country_event = { id = THE_IQU_flavor_events.236 } }
			}
		}
		if = {
			limit = {
				any_owned_province = {
					has_province_flag = THE_IQU_this_provinces_is_exploring_now
					NOT = { region = cascadia_region }
					NOT = { region = peru_region }
					NOT = { region = upper_peru_region }
					NOT = { region = la_plata_region }
					NOT = { region = caribbean_sea_region }
					NOT = { region = southeast_america_region }
					NOT = { region = mississippi_region }
					NOT = { region = canada_region }
					NOT = { region = northeast_america_region }
					NOT = { region = great_lakes_region }
					NOT = { region = colombia_region }
					NOT = { region = brazil_region }
					NOT = { region = central_america_region }
					NOT = { region = australia_region }
					NOT = { region = british_isles_region }
					NOT = { region = orbital_region }
					NOT = { region = moon_region }
				}
			}
			random_list = {
				10 = { country_event = { id = THE_IQU_flavor_events.66 } }
				10 = { country_event = { id = THE_IQU_flavor_events.70 } }
				10 = { country_event = { id = THE_IQU_flavor_events.75 } }
				10 = { country_event = { id = THE_IQU_flavor_events.79 } }
				10 = { country_event = { id = THE_IQU_flavor_events.83 } }
				10 = { country_event = { id = THE_IQU_flavor_events.86 } }
				10 = { country_event = { id = THE_IQU_flavor_events.90 } }
				10 = { country_event = { id = THE_IQU_flavor_events.95 } }
				10 = { country_event = { id = THE_IQU_flavor_events.99 } }
				10 = { country_event = { id = THE_IQU_flavor_events.102 } }
				10 = { country_event = { id = THE_IQU_flavor_events.107 } }
				10 = { country_event = { id = THE_IQU_flavor_events.110 } }
				10 = { country_event = { id = THE_IQU_flavor_events.114 } }
				10 = { country_event = { id = THE_IQU_flavor_events.117 } }
				10 = { country_event = { id = THE_IQU_flavor_events.121 } }
				10 = { country_event = { id = THE_IQU_flavor_events.126 } }
				#
				20 = { country_event = { id = THE_IQU_flavor_events.236 } }
			}
		}
	}
	if = {
		limit = { 
			OR = {
				tag = IQU
				was_tag = IQU
			}
			has_government_attribute = THE_IQU_the_world_all_will_be_known_reform_mechanic
		}
		every_country = {
			limit = {
				war_with = ROOT
			}
			remove_fow = 24
		}
	}
}
#设定收入
THE_IQU_set_yearly_trade_income_with_hvr_effect = {
	#衣玖总竞争力
	set_variable = {
		which = the_iqu_total_heaven_trade_power_im_var_iqu
		value = 0
	}
	#天子总竞争力
	set_variable = {
		which = the_iqu_total_heaven_trade_power_im_var_hvr
		value = 0
	}
	#
	while = {
		limit = { 
			any_owned_province = {
				trade_company_region = th_trade_company_heaven
				NOT = {
					has_province_flag = THE_IQU_has_set_point_trade_province_power_flag
				}
			}
		}
		random_owned_province = {
			limit = {
				trade_company_region = th_trade_company_heaven
				NOT = {
					has_province_flag = THE_IQU_has_set_point_trade_province_power_flag
				}
			}
			ROOT = {
				export_to_variable = {
					variable_name = the_iqu_total_heaven_trade_power_im_var_iqu_single_province
					value = province_trade_power
					who = PREV
				}
				#累加变量
				change_variable = {
					which = the_iqu_total_heaven_trade_power_im_var_iqu
					which = the_iqu_total_heaven_trade_power_im_var_iqu_single_province
				}
			}
			set_province_flag = THE_IQU_has_set_point_trade_province_power_flag
		}
	}
	every_owned_province = {
		limit = {
			trade_company_region = th_trade_company_heaven
		}
		clr_province_flag = THE_IQU_has_set_point_trade_province_power_flag
	}
	while = {
		limit = { 
			#天界的省份贸易
			HVR = {
				any_owned_province = {
					trade_company_region = th_trade_company_heaven
					NOT = {
						has_province_flag = THE_IQU_has_set_point_trade_province_power_flag2
					}
				}
			}
		}
		HVR = {
			random_owned_province = {
				limit = {
					trade_company_region = th_trade_company_heaven
					NOT = {
						has_province_flag = THE_IQU_has_set_point_trade_province_power_flag2
					}
				}
				ROOT = {
					export_to_variable = {
						variable_name = the_iqu_total_heaven_trade_power_im_var_hvr_single_province
						value = province_trade_power
						who = PREV
					}
					#累加变量
					change_variable = {
						which = the_iqu_total_heaven_trade_power_im_var_hvr
						which = the_iqu_total_heaven_trade_power_im_var_hvr_single_province
					}
				}
				set_province_flag = THE_IQU_has_set_point_trade_province_power_flag2
			}
		}
	}
	HVR = {
		every_owned_province = {
			limit = {
				trade_company_region = th_trade_company_heaven
			}
			clr_province_flag = THE_IQU_has_set_point_trade_province_power_flag
		}
	}
	#得出变量
	#龙宫省份贸易竞争力 the_iqu_total_heaven_trade_power_im_var_iqu
	#天界省份贸易竞争力 the_iqu_total_heaven_trade_power_im_var_hvr
	set_variable = {
		which = the_iqu_total_heaven_trade_power_im_var_iqu_view
		which = the_iqu_total_heaven_trade_power_im_var_iqu
	}
	set_variable = {
		which = the_iqu_total_heaven_trade_power_im_var_hvr_view
		which = the_iqu_total_heaven_trade_power_im_var_hvr
	}
	if = {
		limit = {
			check_variable = {
				which = the_iqu_total_heaven_trade_power_im_var_iqu
				which = the_iqu_total_heaven_trade_power_im_var_hvr
			}
		}
		divide_variable = {
			which = the_iqu_total_heaven_trade_power_im_var_hvr
			which = the_iqu_total_heaven_trade_power_im_var_iqu
		}
		set_variable = {
			which = the_iqu_total_heaven_trade_power_im_var_percentage_use
			which = the_iqu_total_heaven_trade_power_im_var_hvr
		}
	}
	else = {
		divide_variable = {
			which = the_iqu_total_heaven_trade_power_im_var_iqu
			which = the_iqu_total_heaven_trade_power_im_var_hvr
		}
		set_variable = {
			which = the_iqu_total_heaven_trade_power_im_var_percentage_use
			which = the_iqu_total_heaven_trade_power_im_var_iqu
		}
	}
	#the_iqu_total_heaven_trade_power_im_var_percentage_use 贸易竞争力差幅
	export_to_variable = {
		which = the_iqu_iqu_years_of_income_im_var
		value = years_of_income
		who = ROOT
	}
	export_to_variable = {
		which = the_iqu_hvr_years_of_income_im_var
		value = years_of_income
		who = HVR
	}
	export_to_variable = {
		which = the_iqu_iqu_years_of_income_im_var_trade_percentage
		value = trade_income_percentage
		who = ROOT
	}
	export_to_variable = {
		which = the_iqu_hvr_years_of_income_im_var_trade_percentage
		value = trade_income_percentage
		who = HVR
	}
	# x5
	multiply_variable = {
		which = the_iqu_iqu_years_of_income_im_var
		value = 5
	}
	multiply_variable = {
		which = the_iqu_hvr_years_of_income_im_var
		value = 5
	}
	# x比例
	multiply_variable = {
		which = the_iqu_iqu_years_of_income_im_var
		which = the_iqu_iqu_years_of_income_im_var_trade_percentage
	}
	multiply_variable = {
		which = the_iqu_hvr_years_of_income_im_var
		which = the_iqu_hvr_years_of_income_im_var_trade_percentage
	}
	#
	change_variable = {
		which = the_iqu_iqu_years_of_income_im_var
		which = the_iqu_hvr_years_of_income_im_var
	}
	#总收入 the_iqu_iqu_years_of_income_im_var
	set_variable = {
		which = the_iqu_total_number_years_of_income_im_var
		which = the_iqu_iqu_years_of_income_im_var
	}
	multiply_variable = {
		which = the_iqu_total_number_years_of_income_im_var
		value = 5
	}
}
THE_IQU_on_5_years_pluse_effect = {
	if = {
		limit = {
			mission_completed = THE_IQU_4_4
		}
		country_event = {
			id = THE_IQU_flavor_events.1011
		}
	}
}
THE_IQU_on_development_adm_effect = {
	if = {
		limit = {
			has_province_modifier = THE_IQU_lonng_vein_foot_province_buff
			owner = {
				mission_completed = THE_IQU_4_6
			}
		}
		random_list = {
			50 = {
				add_base_tax = 1
			}
			50 = {
				
			}
		}
	}
}
THE_IQU_on_development_dip_effect = {
	if = {
		limit = {
			has_province_modifier = THE_IQU_lonng_vein_foot_province_buff
			owner = {
				mission_completed = THE_IQU_4_6
			}
		}
		random_list = {
			50 = {
				add_base_production = 1
			}
			50 = {
				
			}
		}
	}
}
THE_IQU_on_development_mil_effect = {
	if = {
		limit = {
			has_province_modifier = THE_IQU_lonng_vein_foot_province_buff
			owner = {
				mission_completed = THE_IQU_4_6
			}
		}
		random_list = {
			50 = {
				add_base_manpower = 1
			}
			50 = {
				
			}
		}
	}
	
}
#攻城
THE_IQU_naval_on_brrange_effect = {
	if = {
		limit = {
			mission_completed = THE_IQU_5_7
		}
		FROM = {
			change_controller = ROOT
		}
	}
}