##定义探索目标 初始化
THE_IQU_define_expedition_target_effects = {
	random_owned_province = {
		limit = {
			has_province_flag = THE_IQU_province_unique_point_flag
			NOT = {
				has_province_flag = THE_IQU_had_saved_unique_point_flag
			}
		}
		save_event_target_as = THE_IQU_province_unique_1_target
		set_province_flag = THE_IQU_had_saved_unique_point_flag
	}
	random_owned_province = {
		limit = {
			has_province_flag = THE_IQU_province_unique_point_flag
			NOT = {
				has_province_flag = THE_IQU_had_saved_unique_point_flag
			}
		}
		save_event_target_as = THE_IQU_province_unique_2_target
		set_province_flag = THE_IQU_had_saved_unique_point_flag
	}
	random_owned_province = {
		limit = {
			has_province_flag = THE_IQU_province_unique_point_flag
			NOT = {
				has_province_flag = THE_IQU_had_saved_unique_point_flag
			}
		}
		save_event_target_as = THE_IQU_province_unique_3_target
		set_province_flag = THE_IQU_had_saved_unique_point_flag
	}
	random_owned_province = {
		limit = {
			has_province_flag = THE_IQU_province_unique_point_flag
			NOT = {
				has_province_flag = THE_IQU_had_saved_unique_point_flag
			}
		}
		save_event_target_as = THE_IQU_province_unique_4_target
		set_province_flag = THE_IQU_had_saved_unique_point_flag
	}
}

##设定 （异常点）
THE_IQU_add_unique_point_temporary_province_effects = {
	hidden_effect = {
		set_province_flag = THE_IQU_province_unique_point_flag
		#Set DIFFICULT
		set_province_flag = THE_IQU_province_explore_lvl_$level$_flag
	}
	custom_tooltip = THE_IQU_unique_set_temporary_point_c_tt1
	############
	# hidden_effect = {
	# 	random_owned_province = {
	# 		limit = {
	# 			area = $area$
	# 		}
	# 		set_province_flag = THE_IQU_province_unique_point_flag
	# 		#DIFFICULT
	# 		set_province_flag = THE_IQU_province_explore_lvl_$level$_flag
	# 	}
	# }
	# $area$ = {
	# 	custom_tooltip = THE_IQU_unique_set_temporary_point_c_tt1
	# }	
}

##初始化--将要添加危险度，和探险进度
THE_IQU_add_explore_progress_or_dangerous_progress_effects_before = {
	hidden_effect = {
		set_variable = {
			which = the_iqu_will_change_explore_progress
			value = $explore$
		}
		set_variable = {
			which = the_iqu_will_change_danger_progress
			value = $danger$
		}
		THE_IQU_read_the_province_difficult_to_progress_script = yes
	}
}
#读取探险难度进行修正
THE_IQU_read_the_province_difficult_to_progress_script = {
	random_owned_province = {
		limit = {
			has_province_flag = THE_IQU_this_provinces_is_exploring_now
		}
		save_event_target_as = THE_IQU_province_difficult_correct_target
	}
	if = { limit = { event_target:THE_IQU_province_difficult_correct_target = { has_province_flag = THE_IQU_province_explore_lvl_1_flag } } subtract_variable = { which = the_iqu_will_change_explore_progress value = 1.4 } subtract_variable = { which = the_iqu_will_change_danger_progress value = 0.6 } }
	else_if = { limit = { event_target:THE_IQU_province_difficult_correct_target = { has_province_flag = THE_IQU_province_explore_lvl_2_flag } } subtract_variable = { which = the_iqu_will_change_explore_progress value = 1.2 } subtract_variable = { which = the_iqu_will_change_danger_progress value = 0.8 } }
	else_if = { limit = { event_target:THE_IQU_province_difficult_correct_target = { has_province_flag = THE_IQU_province_explore_lvl_3_flag } } subtract_variable = { which = the_iqu_will_change_explore_progress value = 1.0 } subtract_variable = { which = the_iqu_will_change_danger_progress value = 1.0 } }
	else_if = { limit = { event_target:THE_IQU_province_difficult_correct_target = { has_province_flag = THE_IQU_province_explore_lvl_4_flag } } subtract_variable = { which = the_iqu_will_change_explore_progress value = 0.8 } subtract_variable = { which = the_iqu_will_change_danger_progress value = 1.2 } }
	else_if = { limit = { event_target:THE_IQU_province_difficult_correct_target = { has_province_flag = THE_IQU_province_explore_lvl_5_flag } } subtract_variable = { which = the_iqu_will_change_explore_progress value = 0.6 } subtract_variable = { which = the_iqu_will_change_danger_progress value = 1.4 } }
}

THE_IQU_add_explore_progress_or_dangerous_progress_effects = {
	#改变将会改变的进度
	hidden_effect = {
		#改变
		change_variable = {
			which = the_iqu_now_explore_progress
			which = the_iqu_will_change_explore_progress
		}
		change_variable = {
			which = the_iqu_now_danger_progress
			which = the_iqu_will_change_danger_progress
		}
	}
	custom_tooltip = THE_IQU_add_explore_progress_or_dangerous_progres_c_tt1
	##可视化当前探险进度&危险进度
	custom_tooltip = THE_IQU_now_explore_progress_view_c_tt_x
	custom_tooltip = THE_IQU_now_dangerous_progres_view_c_tt_x
	hidden_effect = {
		THE_IQU_on_check_the_progress_event_effect = yes
	}
}
#月球探索探险进度 无视danger
THE_IQU_add_explore_progress_or_dangerous_progress_effects_before_on_moon_once = {
	hidden_effect = {
		set_variable = {
			which = the_iqu_will_change_explore_progress
			value = $explore$
		}
		set_variable = {
			which = the_iqu_will_change_danger_progress
			value = $danger$
		}
	}
}
#月球探索探险进度 无视danger
THE_IQU_add_explore_progress_or_dangerous_progress_effects_on_moon_once = {
	#改变将会改变的进度
	hidden_effect = {
		#改变
		change_variable = {
			which = the_iqu_now_explore_progress
			which = the_iqu_will_change_explore_progress
		}
		change_variable = {
			which = the_iqu_now_danger_progress
			which = the_iqu_will_change_danger_progress
		}
	}
	custom_tooltip = THE_IQU_add_explore_progress_or_dangerous_progres_c_tt1
	##可视化当前探险进度&危险进度
	custom_tooltip = THE_IQU_now_explore_progress_view_c_tt_x
	custom_tooltip = THE_IQU_now_dangerous_progres_view_c_tt_x
}


##探险初始化数值
THE_IQU_on_start_the_explore_event_effects = {
	hidden_effect = {
		set_variable = {
			which = the_iqu_now_explore_progress
			value = 0
		}
		set_variable = {
			which = the_iqu_now_danger_progress
			value = 0
		}
		##
	}
}

##检测探险度是否完成or失败
THE_IQU_on_check_the_progress_event_effect = {
	hidden_effect = {
		if = {
			limit = { 
				check_variable = {
					which = the_iqu_now_explore_progress
					value = 100
				}
			}
			###触发成功事件
			country_event = {
				id = THE_IQU_flavor_events.1000
			}
		}
		else_if = {
			limit = {
				check_variable = {
					which = the_iqu_now_danger_progress
					value = 100
				}
			 }
			 ###触发失败事件
			 country_event = {
				id = THE_IQU_flavor_events.1001
			}
		}
	}
}

##奖励结算-IMMEDIATE
THE_IQU_explore_event_get_benifit_immeditate_script = {
	hidden_effect = {
		random_owned_province = {
			limit = {
				has_province_flag = THE_IQU_this_provinces_is_exploring_now
			}
			save_event_target_as = THE_IQU_province_difficult_about_treasury_target
		}
		set_variable = {
			which = the_iqu_base_treasury_im_var
			value = $base$
		}
		if = { limit = { event_target:THE_IQU_province_difficult_about_treasury_target = { has_province_flag = THE_IQU_province_explore_lvl_1_flag } } subtract_variable = { which = the_iqu_base_treasury_im_var value = 0.6 } }
		else_if = { limit = { event_target:THE_IQU_province_difficult_about_treasury_target = { has_province_flag = THE_IQU_province_explore_lvl_2_flag } } subtract_variable = { which = the_iqu_base_treasury_im_var value = 0.8 } }
		else_if = { limit = { event_target:THE_IQU_province_difficult_about_treasury_target = { has_province_flag = THE_IQU_province_explore_lvl_3_flag } } subtract_variable = { which = the_iqu_base_treasury_im_var value = 1.0 } }
		else_if = { limit = { event_target:THE_IQU_province_difficult_about_treasury_target = { has_province_flag = THE_IQU_province_explore_lvl_4_flag } } subtract_variable = { which = the_iqu_base_treasury_im_var value = 1.2 } }
		else_if = { limit = { event_target:THE_IQU_province_difficult_about_treasury_target = { has_province_flag = THE_IQU_province_explore_lvl_5_flag } } subtract_variable = { which = the_iqu_base_treasury_im_var value = 1.4 } }
		##设置金钱奖励
		set_variable = {
			which = the_iqu_base_treasury_gold_im_var
			which = the_iqu_base_treasury_im_var
		}
		subtract_variable = {
			which = the_iqu_base_treasury_gold_im_var
			value = 2
		}
		#导出奖励修正
		export_to_variable = {
			which = the_iqu_treasury_get_modifier_im_var
			value = modifier:THE_IQU_explore_treasury_get_cutom_modifier
		}
		change_variable = {
			which = the_iqu_treasury_get_modifier_im_var
			value = 1
		}
		subtract_variable = {
			which = the_iqu_base_treasury_im_var
			which = the_iqu_treasury_get_modifier_im_var
		}	
	}
	## 点数奖励变量 the_iqu_base_treasury_im_var
	## 金钱奖励变量 the_iqu_base_treasury_gold_im_var
}
##奖励获取—Effect
THE_IQU_explore_event_get_benifit_effect_effect = {
	#本地化
	custom_tooltip = THE_IQU_explore_get_treasury_point_c_tt1
	hidden_effect = {
		while = {
			limit = { 
				check_variable = {
					which = the_iqu_base_treasury_im_var
					value = 1
				}
			}
			add_adm_power = 1
			add_dip_power = 1
			add_mil_power = 1
			change_variable = {
				which = the_iqu_base_treasury_im_var
				value = -1
			}
		}
		while = {
			limit = { 
				check_variable = {
					which = the_iqu_base_treasury_gold_im_var
					value = 1
				}
			}
			add_treasury = 1
			change_variable = {
				which = the_iqu_base_treasury_gold_im_var
				value = -1
			}
		}
	}
}
##更新「航海经验」变量 the_iqu_nautical_experience_change_im_var
##检测「航海经验」更改触发概率脚本
THE_IQU_check_nautical_experience_change_event_random_effects = {
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 10 } } random_list = { 80 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 20 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 9 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 10 } } } random_list = { 75 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 25 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 8 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 9 } } } random_list = { 70 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 30 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 7 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 8 } } } random_list = { 65 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 35 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 6 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 7 } } } random_list = { 55 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 40 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 5 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 6 } } } random_list = { 50 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 45 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 4 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 5 } } } random_list = { 45 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 50 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 3 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 4 } } } random_list = { 40 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 55 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 2 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 3 } } } random_list = { 35 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 60 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 1 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 2 } } } random_list = { 30 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 65 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 0 } NOT = { check_variable = { which = the_iqu_nautical_experience_change_im_var value = 1 } } } random_list = { 25 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 70 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_c_tt1
}

##更新「才学经验」变量 the_iqu_learning_experience_change_im_var
##检测「才学经验」更改触发概率脚本
THE_IQU_check_learning_experience_change_event_random_effects = {
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 10 } } random_list = { 80 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 20 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 9 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 10 } } } random_list = { 75 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 25 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 8 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 9 } } } random_list = { 70 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 30 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 7 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 8 } } } random_list = { 65 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 35 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 6 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 7 } } } random_list = { 55 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 40 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 5 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 6 } } } random_list = { 50 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 45 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 4 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 5 } } } random_list = { 45 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 50 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 3 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 4 } } } random_list = { 40 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 55 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 2 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 3 } } } random_list = { 35 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 60 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 1 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 2 } } } random_list = { 30 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 65 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 0 } NOT = { check_variable = { which = the_iqu_learning_experience_change_im_var value = 1 } } } random_list = { 25 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 70 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	custom_tooltip = THE_IQU_check_learning_experience_change_event_effect_c_tt1
}
##更新「外交经验」变量 the_iqu_diplomacal_experience_change_im_var
##检测「外交经验」更改触发概率脚本
THE_IQU_check_diplomacal_experience_change_event_random_effects = {
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 10 } } random_list = { 80 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 20 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 9 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 10 } } } random_list = { 75 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 25 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 8 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 9 } } } random_list = { 70 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 30 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 7 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 8 } } } random_list = { 65 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 35 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 6 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 7 } } } random_list = { 55 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 40 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 5 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 6 } } } random_list = { 50 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 45 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 4 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 5 } } } random_list = { 45 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 50 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 3 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 4 } } } random_list = { 40 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 55 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 2 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 3 } } } random_list = { 35 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 60 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 1 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 2 } } } random_list = { 30 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 65 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	if = { limit = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 0 } NOT = { check_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 1 } } } random_list = { 25 = { hidden_effect = { country_event = { id = $better_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1 } 70 = { hidden_effect = { country_event = { id = $bad_id$ days = 2 } } custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2 } } }
	custom_tooltip = THE_IQU_check_diplomacal_experience_change_event_effect_c_tt1
}
##检测 触发「一般」事件
THE_IQU_check_none_normal_change_event_random_effects = {
	hidden_effect = {
		country_event = {
			id = $ne_id$
			days = 2
		}
	}
	custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt3
}
##检测 触发「成功」事件
THE_IQU_check_none_success_change_event_random_effects = {
	hidden_effect = {
		country_event = {
			id = $better_id$
			days = 2
		}
	}
	custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt1
}
##检测 触发「失败」事件
THE_IQU_check_none_fail_change_event_random_effects = {
	hidden_effect = {
		country_event = {
			id = $bad_id$
			days = 2
		}
	}
	custom_tooltip = THE_IQU_check_nautical_experience_change_event_effect_e_tt2
}
##「成功」的事件清除
THE_IQU_clr_the_exploring_now_success_effect = {
	hidden_effect = {
		random_owned_province = {
			limit = {
				has_province_flag = THE_IQU_this_provinces_is_exploring_now
			}
			#清除难度 flag
			clr_province_flag = THE_IQU_province_explore_lvl_1_flag
			clr_province_flag = THE_IQU_province_explore_lvl_2_flag
			clr_province_flag = THE_IQU_province_explore_lvl_3_flag
			clr_province_flag = THE_IQU_province_explore_lvl_4_flag
			clr_province_flag = THE_IQU_province_explore_lvl_5_flag
			#清除异常点
			clr_province_flag = THE_IQU_province_unique_point_flag
			#设立完成标记
			set_province_flag = THE_IQU_this_province_had_been_explored_flag
		}
		#清除正在探索
		random_owned_province = {
			limit = {
				has_province_flag = THE_IQU_this_provinces_is_exploring_now
			}
			clr_province_flag = THE_IQU_this_provinces_is_exploring_now
		}
		clr_country_flag = THE_IQU_now_is_exploring_flag
		##事件持有清除
		clr_country_flag = THE_IQU_had_explore_event
		clr_country_flag = THE_IQU_having_explore_event
		THE_IQU_add_fengshui_wuxing_province_permant_buff_effect = yes 
	}
}
## 添加风水五行之期
THE_IQU_add_fengshui_wuxing_province_permant_buff_effect = {
	if = {
		limit = {
			region = {
				type = all
				NOT = { has_province_modifier = THE_IQU_Feng_shui_jin_buff }
				NOT = { has_province_modifier = THE_IQU_Feng_shui_shui_buff }
				NOT = { has_province_modifier = THE_IQU_Feng_shui_mu_buff }
				NOT = { has_province_modifier = THE_IQU_Feng_shui_huo_buff }
				NOT = { has_province_modifier = THE_IQU_Feng_shui_tu_buff }
			}
		}
		random_list = {
			20 = {
				add_province_modifier = {
					name = THE_IQU_Feng_shui_jin_buff
					duration = -1
				}
			}
			20 = {
				add_province_modifier = {
					name = THE_IQU_Feng_shui_shui_buff
					duration = -1
				}
			}
			20 = {
				add_province_modifier = {
					name = THE_IQU_Feng_shui_mu_buff
					duration = -1
				}
			}
			20 = {
				add_province_modifier = {
					name = THE_IQU_Feng_shui_huo_buff
					duration = -1
				}
			}
			20 = {
				add_province_modifier = {
					name = THE_IQU_Feng_shui_tu_buff
					duration = -1
				}
			}
		}
		if = {
			limit = {
				mission_completed = THE_IQU_2_5
			}
			change_trade_goods = paper
		}
	}
}
#「失败」的事件清除
THE_IQU_clr_the_exploring_now_fail_effect = {
	hidden_effect = {
		random_owned_province = {
			limit = {
				has_province_flag = THE_IQU_this_provinces_is_exploring_now
			}
			clr_province_flag = THE_IQU_this_provinces_is_exploring_now
		}
		clr_country_flag = THE_IQU_now_is_exploring_flag
		##事件持有清除
		clr_country_flag = THE_IQU_had_explore_event
		clr_country_flag = THE_IQU_having_explore_event
	}
}
# 添加 威望 溢出转化
THE_IQU_add_prestige_or_navy_tradition_effects = {
	tooltip = {
		add_prestige = $value$
		custom_tooltip = THE_IQU_add_prestige_or_navy_tradition_c_tt1
	}
	hidden_effect = {
		for = {
			amount = $value$
			effect = "
				if = {
					limit = { 
						NOT = {
							prestige = 100
						}
					}
					add_prestige = 1
				}
				else = {
					add_navy_tradition = 0.5
				}
			"
		}
	}
}
# 引导龙脉添加建筑
THE_IQU_guide_the_lonng_vein_custom_gui_script = {
	custom_tooltip = THE_IQU_guide_the_loong_vein_building_construction_scripted_c_tt1
	add_building_construction = {
		building = THE_IQU_guide_the_loong_vein_building
		cost = 1.0
		speed = 1.0
	}
}
#建筑效果
THE_IQU_guide_the_loong_vein_building_construction_scripted = {
	hidden_effect = {
		if = {
			limit = { 
				any_neighbor_province = {
					has_province_modifier = THE_IQU_lonng_vein_head_province_buff
				}
			}
			random_neighbor_province = {
				limit = {
					has_province_modifier = THE_IQU_lonng_vein_head_province_buff
				}
				remove_province_modifier = THE_IQU_lonng_vein_head_province_buff
				add_province_modifier = {
					name = THE_IQU_lonng_vein_foot_province_buff
					duration = 7300
				}
				THE_IQU_move_wuxing_loong_province_flag_effect = yes
			}
		}
		else = {
			sea_zone = {
				random_neighbor_province = {
					limit = {
						has_province_modifier = THE_IQU_lonng_vein_head_province_buff
					}
					remove_province_modifier = THE_IQU_lonng_vein_head_province_buff
					add_province_modifier = {
						name = THE_IQU_lonng_vein_foot_province_buff
						duration = 7300
					}
					THE_IQU_move_wuxing_loong_province_flag_effect = yes
				}	
			}
		}
		add_province_modifier = {
			name = THE_IQU_lonng_vein_head_province_buff
			duration = -1
		}
		THE_IQU_will_check_province_fengshui_and_add_next_flag_effect = yes
	}
}
#建筑检测 当地风水，获得flag以及下一期五行
# THE_IQU_loong_vein_get_wuxing_jin_flag 已获得五行-金
# THE_IQU_loong_vein_get_wuxing_shui_flag 已获得五行-水
# THE_IQU_loong_vein_get_wuxing_mu_flag 已获得五行-木
# THE_IQU_loong_vein_get_wuxing_huo_flag 已获得五行-火
# THE_IQU_loong_vein_get_wuxing_tu_flag 已获得五行-土

####
# THE_IQU_loong_vein_get_wuxing_jin_flag_next 下一期-金
# THE_IQU_loong_vein_get_wuxing_shui_flag_next 下一期-水
# THE_IQU_loong_vein_get_wuxing_mu_flag_next 下一期-木
# THE_IQU_loong_vein_get_wuxing_huo_flag_next 下一期-火
# THE_IQU_loong_vein_get_wuxing_tu_flag_next 下一期-土
THE_IQU_will_check_province_fengshui_and_add_next_flag_effect = {
	THE_IQU_will_check_province_fengshui_and_add_next_flag_script = { wuxing = jin next = shui }
	THE_IQU_will_check_province_fengshui_and_add_next_flag_script = { wuxing = shui next = mu }
	THE_IQU_will_check_province_fengshui_and_add_next_flag_script = { wuxing = mu next = huo }
	THE_IQU_will_check_province_fengshui_and_add_next_flag_script = { wuxing = huo next = tu }
	THE_IQU_will_check_province_fengshui_and_add_next_flag_script = { wuxing = tu next = jin }
}
THE_IQU_will_check_province_fengshui_and_add_next_flag_script = {
	if = {
		limit = { 
			has_province_modifier = THE_IQU_Feng_shui_$wuxing$_buff
			has_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag_next
		}
		THE_IQU_will_clr_all_next_wuxing_province_flag_effect = yes
		set_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag
		set_province_flag = THE_IQU_loong_vein_get_wuxing_$next$_flag_next
	}
}
#清除所有下一期五行标签
THE_IQU_will_clr_all_next_wuxing_province_flag_effect = {
	clr_province_flag = THE_IQU_loong_vein_get_wuxing_jin_flag_next
	clr_province_flag = THE_IQU_loong_vein_get_wuxing_shui_flag_next
	clr_province_flag = THE_IQU_loong_vein_get_wuxing_mu_flag_next
	clr_province_flag = THE_IQU_loong_vein_get_wuxing_huo_flag_next
	clr_province_flag = THE_IQU_loong_vein_get_wuxing_tu_flag_next
}
#转移省份标签
THE_IQU_move_wuxing_loong_province_flag_effect = {
	THE_IQU_move_wuxing_loong_province_flag_script = { wuxing = jin }
	THE_IQU_move_wuxing_loong_province_flag_script = { wuxing = shui }
	THE_IQU_move_wuxing_loong_province_flag_script = { wuxing = mu }
	THE_IQU_move_wuxing_loong_province_flag_script = { wuxing = huo }
	THE_IQU_move_wuxing_loong_province_flag_script = { wuxing = tu }
}
THE_IQU_move_wuxing_loong_province_flag_script = {
	if = {
		limit = { 
			THIS = {
				has_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag
			}
		}
		THIS = {
			clr_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag
		}
		ROOT = {
			set_country_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag
		}
	}
	if = {
		limit = { 
			THIS = {
				has_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag_next
			}
		}
		THIS = {
			clr_province_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag_next
		}
		ROOT = {
			set_country_flag = THE_IQU_loong_vein_get_wuxing_$wuxing$_flag_next
		}
	}
}

################################
##On Action Script
##############################
THE_IQU_on_startup_scripted_effects = {
	if = {
		limit = {
			tag = IQU
			NOT = { has_country_flag = THE_IQU_on_startup_set_variable_flag }
		}
		set_variable = { which = the_iqu_nautical_experience_change_im_var value = 0 }
		set_variable = { which = the_iqu_learning_experience_change_im_var value = 0 }
		set_variable = { which = the_iqu_diplomacal_experience_change_im_var value = 0 }
		#MISSION 
		set_variable = { which = the_iqu_explore_province_number_im_var value = 0 }
		set_country_flag = THE_IQU_on_startup_set_variable_flag
	}
}
#探索海岸 FROM己方国家 #ROOT当前省份
THE_IQU_explore_coast_exolore_government_effects = {
	if = {
		limit = {
			FROM = {
				has_government_attribute = THE_IQU_government_explore_coast_explore_mechanic
			}
		 }
		 random_list = {
			10 = {
				ROOT = {
					region = {
						 discover_country = FROM
					}
				}
			}
			90 = {
				
			}
		 }
		 
	}
}
#所有的area完成殖民
THE_IQU_scarlet_sky_government_effects = {
	if = {
		limit = {
			owner = {
				has_government_attribute = THE_IQU_scarlet_sky_reform_mechanic
			}
		}
		every_province_in_state = {
			create_colony = 1000
		}
	}
}
#探索省份数量计数
THE_IQU_number_explore_province_im_var_effect = {
	if = {
		limit = { 
			FROM = {
				has_government_attribute = THE_IQU_government_explore_coast_explore_mechanic
			}
		}
		FROM = {
			change_variable = {
				#探险计数
				which = the_iqu_explore_province_number_im_var
				value = 1
			}
		}
	}
}
#触发异常点事件


#巴拿马
THE_IQU_panama_add_unique_point_event_effect = {
	if = {
		limit = { 
			FROM = {
				OR = {
					tag = IQU
					was_tag = IQU
				}
			}
		}
		province_event = {
			id = THE_IQU_flavor_events.60
		}
	}
}